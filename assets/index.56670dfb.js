var xt=Object.defineProperty,wt=Object.defineProperties;var Tt=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var ye=(t,e,n)=>e in t?xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,N=(t,e)=>{for(var n in e||(e={}))ze.call(e,n)&&ye(t,n,e[n]);if(se)for(var n of se(e))Be.call(e,n)&&ye(t,n,e[n]);return t},O=(t,e)=>wt(t,Tt(e));var be=(t,e)=>{var n={};for(var r in t)ze.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&se)for(var r of se(t))e.indexOf(r)<0&&Be.call(t,r)&&(n[r]=t[r]);return n};var L=(t,e,n)=>(ye(t,typeof e!="symbol"?e+"":e,n),n);import{E as I,u as oe,r as y,a as g,j as u,c as Z,T as ae,l as U,f as Le,b as Fe,d as $,F as z,e as ve,g as xe,h as we,i as ie,R as Q,P as k,N as x,k as F,m as $e,n as _t,o as m,p as je,q as j,s as qe,t as St,v as Et,_ as Te,w as le,x as _e,y as He,z as kt,A as We,B as Ue,C as Ve,D as Qe,G as Ge,I as Mt,H as Ct,J as Pt,K as Nt,L as ce,M as At,O as Rt,Q as ue,S as Ke,U as pe,V as Ot,W as Dt,X as It,Y as zt,Z as Ye,$ as Bt,a0 as Lt,a1 as Ft,a2 as $t,a3 as jt,a4 as qt,a5 as Ht,a6 as Wt,a7 as Ut,a8 as Xe,a9 as Se,aa as Vt,ab as Qt,ac as Gt,ad as Ee,ae as Kt,af as ke}from"./vendor.0e7aef43.js";const Yt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};Yt();var S;(function(t){t[t.flow=16]="flow",t[t.list=32]="list",t[t.phrasing=48]="phrasing",t[t.staticPhrasing=49]="staticPhrasing",t[t.value=64]="value",t[t.table=80]="table",t[t.tableRow=96]="tableRow"})(S||(S={}));function G(t,e){return t===e||t<e&&(t^e)<16}function B(t){return O(N({},t),{register(e){e.define(O(N({},t),{isEditable:typeof t.isEditable=="boolean"?t.isEditable:!0}))}})}function R(t,e){return I.isElement(t)?e instanceof Array?e.indexOf(t.type)>=0:t.type===e:!1}function Je({icon:t,active:e,disabled:n,action:r,tips:s}){const i=oe(),a=y.exports.useCallback(l=>{r&&l.button===0&&(l.preventDefault(),l.stopPropagation(),n||g.withoutNormalizing(i,()=>{r(l)}))},[r]),o=u("span",{className:Z("a-editor-toolbar-item",{active:e,disabled:n}),onMouseDown:a,children:t});return s?u(ae,{content:u("span",{className:"toolbar-item-tips",children:s}),children:o}):o}U.add(Le,Fe);function Xt({extraWidth:t,isEmpty:e,element:n,items:r,setActive:s}){return u(ae,{appendTo:"parent",arrow:!1,content:Jt(r),hideOnClick:!1,interactive:!0,onHide:()=>s(!1),onShow:()=>s(!0),children:$("div",{className:"line-operations",contentEditable:!1,children:[u("span",{className:"icon",children:u(z,{icon:e?Fe:Le})}),u("div",{className:"spacer",style:{width:t,height:"100%"}})]})})}const Jt=t=>u("div",{className:"block-toolbar",children:t.map((e,n)=>u("div",{className:"toolbar-group",children:e.map(r=>u(Je,{action:r.action,active:r.active,disabled:r.disabled,icon:r.icon,tips:r.tips},r.key))},n))});U.add(ve,xe,we,ie);function Ze(t,e){if(!!e)return typeof e=="function"?e(t):e}function Zt(t,e){const n=e==null?void 0:e.current;return n?t.factory.lineActions.map(r=>t.getActions(n,r).map(({action:{key:s,icon:i,tips:a},state:o})=>({key:s,disabled:o.disabled,active:o.active,icon:Ze(o,i),tips:Ze(o,a),action:l=>{t.runAction(s,n,l)}}))):[]}function et(){const[t,e]=y.exports.useState(0);return()=>{e(n=>n+1)}}const tt=y.exports.createContext({getEditorDOMRect:()=>new DOMRect});function ee({element:t,children:e}){const[n,r]=y.exports.useState(null),s=y.exports.useRef(),i=oe(),a=Zt(i,s.current),o=et(),[l,c]=y.exports.useState(0),{getEditorDOMRect:h}=y.exports.useContext(tt),b=y.exports.useCallback(()=>{var v;const _=(v=n==null?void 0:n.getBoundingClientRect())!=null?v:new DOMRect,{x:f=0}=_,{x:d}=h();return c(f-d),_},[h,n]);y.exports.useLayoutEffect(()=>{var _,f;if(n){const d=document.createRange();d.selectNode(n.childNodes.item(0));const v=Q.toSlateRange(i,d,{exactMatch:!1});let C=k.common(v.anchor.path,v.focus.path);for(;C.length!==0;){if(g.isBlock(i,x.get(i,C))){s.current=g.pathRef(i,C);break}C=k.parent(C)}}else s.current&&((f=(_=s.current).unref)==null||f.call(_)),s.current=void 0},[n]);const[w,E]=y.exports.useState(!1),p=(()=>{const _=t.children[0];return t.children.length===1&&F.isText(_)&&_.text===""})();return $e()?typeof e=="function"?e({active:w,pathRef:s.current}):e:u(_t,{appendTo:document.body,arrow:!1,getReferenceClientRect:b,hideOnClick:!1,interactive:!0,interactiveBorder:12,offset:[0,8],onTrigger:o,placement:"left",popperOptions:{modifiers:[{name:"flip",options:{allowedAutoPlacements:["left"]}}]},ref:r,render:()=>u(Xt,{element:t,extraWidth:l,isEmpty:p,items:a,setActive:E}),children:typeof e=="function"?e({active:w,pathRef:s.current}):e})}const en=["markdown","javascript","typescript","jsx","tsx","sql","bash","go","rust","json","log"],te=Symbol("prism_token"),nt=({attributes:t,element:e,children:n},r)=>u("pre",O(N({},t),{className:Z({active:r},e.lang?`language-${e.lang}`:void 0),children:u("code",{className:"prism-code",children:n})})),rt=B({type:"code",isInline:!1,isLeaf:!1,wrappingParagraph:!1,contentType:S.flow,contentModelType:S.value,render:(t,e)=>{const{element:n}=e;return $e()?nt(e,!1):u(ee,{element:n,children:({active:s,pathRef:i})=>u(ae,{appendTo:document.body,content:u("select",{className:"lang-selector",contentEditable:!1,onChange:a=>{(i==null?void 0:i.current)&&m.setNodes(t,{lang:a.currentTarget.value},{at:i.current})},tabIndex:void 0,value:n.lang||void 0,children:en.map(a=>u("option",{children:a},a))}),interactive:!0,placement:"top-start",children:nt(e,s)})})},toggle:{prefix:/^`{3}(?: (\w+))?$/,toggle:(t,e,n)=>t.runAction("toggle-codeblock",e),onTrigger:(t,e,n)=>{if(n.length>1)return;const r=/^`{3}(?: (\w+))?$/.exec(t);return r?{lang:r[1]||"markdown",meta:void 0}:{lang:"markdown",meta:void 0}}},events:{},decorate:(t,[e,n],r)=>{if(F.isText(e)&&r.lang){const s=je.languages[r.lang];if(!s)return[];const i=[],a=je.tokenize(e.text,s);let o=0;for(const l of a){const c=st(l),h=o+c;typeof l!="string"&&i.push({[te]:l.type,anchor:{path:n,offset:o},focus:{path:n,offset:h}}),o=h}return i}return[]}}),st=t=>typeof t=="string"?t.length:typeof t.content=="string"?t.content.length:t.content.reduce((e,n)=>e+st(n),0);var tn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",SYMBOL_PRISM_TOKEN:te,default:rt}),A;(function(t){t.strong="strong",t.emphasis="emphasis",t.delete="delete",t.inlineCode="inlineCode"})(A||(A={}));const Me=B({isLeaf:!0,contentType:S.staticPhrasing,contentModelType:S.value,canContainsContentModelTypeOf:t=>t.inlineCode?S.value:(t.strong||t.emphasis||t.delete,S.phrasing),normalize:(t,e,n,r)=>{if(e.text===""){const s=[A.strong,A.emphasis,A.delete,A.inlineCode].filter(i=>!!e[i]);s.length>0&&m.unsetNodes(t,s,{at:n})}},render(t,{leaf:e,children:n,attributes:r}){let s=n;return e[te]&&(s=u("span",{className:Z(e[te]?`token ${e[te]}`:void 0,r.className),children:s})),e.delete&&(s=u("del",{children:s})),e.emphasis&&(s=u("em",{children:s})),e.strong&&(s=u("strong",{children:s})),e.inlineCode&&(s=u("code",{children:s})),u("span",O(N({},r),{children:s}))},toggleDecorator:(t,e,n)=>{const r=at(t),s=i=>r(x.get(t,i.anchor.path),i.anchor.path);Ce(t,e,n)?j.isCollapsed(e)?s(e)&&g.addMark(t,n,!1):m.setNodes(t,{[n]:!1},{match:r,split:!0}):j.isCollapsed(e)?s(e)&&(g.addMark(t,n,!0),n===A.inlineCode?(g.addMark(t,A.inlineCode,!1),g.addMark(t,A.emphasis,!1),g.addMark(t,A.delete,!1)):g.addMark(t,A.inlineCode,!1)):(m.setNodes(t,{[n]:!0},{match:r,split:!0}),n===A.inlineCode?m.unsetNodes(t,[A.delete,A.emphasis,A.strong],{match:r,split:!0}):m.unsetNodes(t,A.inlineCode,{match:r,split:!0}))}});function Ce(t,e,n){if(!Q.hasRange(t,e))return!1;const r=g.marks(t);return r?!!r[n]:!1}const ot=(t,e)=>{const[n]=g.nodes(t,{at:e,match:r=>!t.isEditable(r)});return!n},fe=(t,e)=>{const n=Pe(t),[r]=g.nodes(t,{at:e,match:n});return!!r},at=t=>(e,n)=>{const r=Pe(t);if(!F.isText(e))return!1;const s=x.parent(t,n);return I.isElement(s)?r(s,k.parent(n)):!1},Pe=t=>(e,n)=>{if(I.isElement(e)){const r=t.factory.customElementMap.get(e.type);return r&&r.contentModelType?G(r.contentModelType,S.phrasing):!1}else return!1};function Ne(t,e,n,r){if(j.isRange(e)){if(!Q.hasRange(t,e))return!1}else if(k.isPath(e)){if(!g.hasPath(t,e))return!1}else if(!Q.hasRange(t,{anchor:e,focus:e}))return!1;if(k.isPath(e)){const i=x.get(t,e);return R(i,n)&&(r?r(i):!0)}const[s]=g.nodes(t,{at:j.isRange(e)?g.unhangRange(t,e):e,match:i=>!g.isEditor(i)&&R(i,n)&&(r?r(i):!0)});return!!s}var nn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get TextNodeDecorator(){return A},isDecoratorActive:Ce,isRangeEditable:ot,isRangeCustomTextPropsEnabled:fe,isCustomTextPropsEnabled:at,isPhrasing:Pe,isElementActive:Ne,default:Me});U.add(qe);const Ae=B({type:"link",isInline:!0,isLeaf:!1,contentType:S.phrasing,contentModelType:S.staticPhrasing,normalize:(t,e,n,r)=>{x.string(e).trim().length===0&&(m.removeNodes(t,{at:n}),r())},render:(t,{element:e,attributes:n,children:r})=>u("a",O(N({href:e.url,onClick:()=>window.open(e.url,"_blank"),style:{display:"inline-flex",cursor:"pointer"}},n),{children:r})),insert:(t,e,s)=>{var i=s,{text:n}=i,r=be(i,["text"]);m.insertNodes(t,[N({type:"link",children:[{text:n}]},r),{text:" "}],{at:e,select:!0}),St.isPoint(e)&&m.move(t,{distance:1})},match:{regexp:Et()}});var rn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ae});class sn{constructor(e,n){L(this,"state",[]);this.factory=e,this.editor=n}process(e){const[n,r]=e;if(g.isEditor(n))return this.state=[],[];if(I.isElement(n)){const s=this.factory.customElementMap.get(n.type);if(s&&!s.isInline){const i=s;if(i.decorate)return this.state.push({element:n,path:r,config:i}),[]}}if(this.state.length>0){for(const s of this.state.reverse())if(k.isAncestor(s.path,r))return s.config.decorate(this.editor,e,s.element)}return[]}}class on{constructor(){L(this,"blockConfigs",[]);L(this,"inlineConfigs",[]);L(this,"textConfig");L(this,"inlineSet",new Set);L(this,"voidSet",new Set);L(this,"nonEditableSet",new Set);L(this,"customElementMap",new Map);L(this,"contentTypeMap",new Map);L(this,"contentModelTypeMap",new Map);L(this,"editorWrapHandlers",[]);L(this,"editorMountedHandlers",[])}use(e){return console.debug("factory.use",e.name),e(this),this}define(e){return e.isLeaf?this.textConfig=e:(e.isInline?(this.inlineSet.add(e.type),this.inlineConfigs.push(e)):this.blockConfigs.push(e),this.customElementMap.set(e.type,e),this.contentModelTypeMap.set(e.type,e.contentModelType),this.contentTypeMap.set(e.type,e.contentType),e.contentModelType===null&&this.voidSet.add(e.type),e.isEditable&&this.nonEditableSet.add(e.type)),this}onWrapEditor(e){this.editorWrapHandlers.push(e)}onEditorMounted(e){this.editorMountedHandlers.push(e)}triggerEditorMounted(e){this.editorMountedHandlers.forEach(n=>n(e))}wrapEditor(e){const{isVoid:n,isInline:r,normalizeNode:s,insertBreak:i}=e;e.factory=this;function a(o){g.isEditor(o)?(console.group("#root"),o.children.forEach(a),console.groupEnd()):I.isElement(o)?(console.group(o.type),o.children.forEach(a),console.groupEnd()):console.debug("text")}return window.debugPrintTree=()=>a(e),window.debugEditor=e,e.isContent=(o,l)=>I.isElement(o)?this.contentTypeMap.get(o.type)===l:F.isText(o)?this.textConfig.contentType===l:!1,e.canContainsContent=(o,l)=>{if(g.isEditor(o))return l===S.flow;if(I.isElement(o)){const c=this.contentModelTypeMap.get(o.type);return c?G(l,c):!1}else return F.isText(o)?G(l,Me.canContainsContentModelTypeOf(o)):!1},e.getContentType=o=>I.isElement(o)?this.contentTypeMap.get(o.type)||null:F.isText(o)&&this.textConfig.contentType||null,e.getContentModelType=o=>g.isEditor(o)?S.flow:I.isElement(o)?this.contentModelTypeMap.get(o.type)||null:F.isText(o)?this.textConfig.contentModelType:null,e.getContentTypePair=o=>I.isElement(o)?[this.contentTypeMap.get(o.type)||null,this.contentModelTypeMap.get(o.type)||null]:F.isText(o)?[this.textConfig.contentType||null,this.textConfig.contentModelType||null]:[null,null],e.toggle=(o,l,c)=>{const h=e.canToggle(o,l,!0);if(!h)return!1;const[[b,w],E]=h,p=typeof c=="object"?c:{};switch(E){case Y.replace:return m.unsetNodes(e,Object.keys(x.extractProps(b)),{at:w}),m.setNodes(e,O(N({type:l.type},p),{children:[]}),{at:w}),!0;case Y.wrap:return m.wrapNodes(e,N({type:l.type},p),{at:w}),!0;case Y.custom:throw new Error("TODO: ToggleStrategy.custom");default:throw new Error("unknown ToggleStrategy: "+E)}},e.canToggle=(o,l,c)=>{const[h]=o,[b,w]=e.getContentTypePair(h);if(l.contentType!==b)return!1;if(l.contentModelType===w)return[o,Y.replace];if(l.contentModelType===b)return[o,Y.wrap];if(!c)return!1;const E=x.ancestors(e,o[1],{reverse:!0});for(const p of E){const T=e.canToggle(p,l,!1);if(T)return T}return!1},e.unwrap=(o,l)=>{if(!e.canUnwrap(o,l))return!1;const[c,h]=o,b=[[[]]];let w=[[c,[]]],E=0;for(;E<l.length-1;){const p=[];for(const[T,_]of w)for(const[f,d]of T.children.entries())p.push([d,_.concat(f)]);E+=1,w=p,b.push(p.map(([,T])=>T))}for(const p of b.reverse())for(const T of p.reverse())m.unwrapNodes(e,{at:h.concat(T),split:!0});return!0},e.canUnwrap=([o,l],c)=>{if(c.length===0)return!0;const h=e.getContentModelType(x.parent(e,l)),b=c[c.length-1].contentModelType;if(!h||!b||!G(b,h))return!1;let w=[[o,[]]],E=0;for(;E<c.length;){const p=[];for(const[T,_]of w){if(!R(T,c[E].type))return!1;for(const[f,d]of T.children.entries())p.push([d,_.concat(f)])}E+=1,w=p}return!0},e.wrap=(o,l,c)=>{if(!e.canWrap(o,l,c))return!1;const[,h]=o;let b=l.length-1;for(;b>=0;){const w=l[b],E=c[b];m.wrapNodes(e,Object.assign({type:w.type,children:[]},E),{at:h}),b--}return!0},e.canWrap=(o,l,c)=>{console.assert(l.length===c.length,"editor.canWrap: configs.length should be equals to params.length");const[h,b]=o,w=x.parent(e,b);let E=0,p=e.getContentModelType(w);for(;E<l.length;){const _=l[E];if(p===null||!G(_.contentType,p))return!1;p=_.contentModelType,E+=1}if(p===null)return!1;const T=e.getContentType(h);return T?G(T,p):!1},e.nearest=(o,l)=>{const[c,h]=o;if(R(c,l.type))return o;for(const b of x.ancestors(e,h,{reverse:!0}))if(R(b[0],l.type))return b},e.isVoid=o=>this.voidSet.has(o.type)||n(o),e.isInline=o=>this.inlineSet.has(o.type)||r(o),e.isEditable=o=>I.isElement(o)?this.nonEditableSet.has(o.type):!0,e.normalizeNode=o=>{let l=!0;const c=()=>{l=!1};g.withoutNormalizing(e,()=>{var w;const[h,b]=o;if(I.isElement(h)){const E=(w=this.customElementMap.get(h.type))==null?void 0:w.normalize;E&&E(e,h,b,c)}F.isText(h)&&this.textConfig.normalize&&this.textConfig.normalize(e,h,b,c),g.isEditor(h)&&(h.children.length===0?m.insertNodes(e,{type:"paragraph",children:[{text:""}]},{at:[0]}):R(h.children[h.children.length-1],"paragraph")||m.insertNodes(e,{type:"paragraph",children:[{text:""}]},{at:[h.children.length]}))}),l&&s(o)},e.insertBreak=()=>{if(e.selection){const o=x.parent(e,e.selection.anchor.path);if(e.getContentModelType(o)!==S.phrasing){m.insertText(e,`
`);return}}i()},this.editorWrapHandlers.forEach(o=>o(e)),e}createDefaultEditableProps(e){const n=p=>{var _;const{selection:T}=e;if(T&&j.isCollapsed(T)){const f=T.anchor,d=x.get(e,f.path),v=x.parent(e,f.path);if(F.isText(d)&&I.isElement(v)&&v.type==="paragraph"&&p.data===" "&&!k.hasPrevious(f.path)){const C=d.text.slice(0,f.offset);for(const{toggle:P}of this.blockConfigs)if(!(typeof P.estimatePrefixLength=="number"&&C.length>P.estimatePrefixLength)&&((_=P.prefix)==null?void 0:_.test(C))){const D=P.onTrigger(C,e,k.parent(f.path));if(typeof D!="undefined"){m.delete(e,{at:{path:f.path,offset:0},distance:f.offset}),P.toggle(e,k.parent(f.path),D),p.preventDefault();return}}}if(F.isText(d)&&!R(v,"link")&&p.data===" "){for(const C of this.inlineConfigs)if(C.match){const P=C.match.regexp.exec(d.text.slice(0,f.offset));if(P){const D=P[0],W=P.index,X=P.index+D.length,re={anchor:{path:f.path,offset:W},focus:{path:f.path,offset:X}};Ae.insert(e,re,{url:D,title:"",text:D}),p.preventDefault();return}}}if(g.isInline(e,v)){const C=k.parent(f.path).concat(v.children.length);m.insertNodes(e,{text:p.data||""},{at:C}),m.move(e,{distance:1}),p.preventDefault();return}}},r=(p,T)=>_=>{const{selection:f}=e;if(f&&j.isCollapsed(f)){const d=f.anchor,v=k.parent(d.path),C=x.get(e,v);if(I.isElement(C)){const P=this.customElementMap.get(C.type);if(!P||P.isInline)return;const D=T(P.events);if(D&&D(e,d.path)){_.preventDefault();return}if(an(e,d)){if(P){const W=p(P.events);if(W&&W(e,d.path)){_.preventDefault();return}}if(C.type==="paragraph"){const W=x.parent(e,v);if(!k.hasPrevious(v)&&I.isElement(W)){const X=this.customElementMap.get(W.type);if(X==null?void 0:X.wrappingParagraph){const re=p(X.events);if(re&&re(e,d.path)){_.preventDefault();return}}}}}}}},s=r(p=>p.onStartDelete,p=>p.onDeleteText),i=r(p=>p.onStartEnter,p=>p.onInsertParagraph),o=(p=>T=>{const{selection:_}=e;if(_&&j.isCollapsed(_)){const f=_.anchor,d=k.parent(f.path),v=x.parent(e,f.path);if(I.isElement(v)){const C=this.customElementMap.get(v.type);if(C){const P=p(C.events);if(P&&P(e,f.path)){T.preventDefault();return}}if(v.type==="paragraph"){const P=x.parent(e,d);if(I.isElement(P)){const D=this.customElementMap.get(P.type);if(D==null?void 0:D.wrappingParagraph){const W=p(D.events);if(W&&W(e,f.path)){T.preventDefault();return}}}}}}})(p=>p.onTab),l=new sn(this,e),c=p=>l.process(p),h=(p,T)=>{const _=T?g.rangeRef(e,T):null;e.uploadFile&&Promise.all(p.map(e.uploadFile)).then(f=>f.map((d,v)=>({type:"image",url:d,title:void 0,alt:p[v].name,children:[{text:""}]}))).then(f=>{var d;m.insertNodes(e,f,{at:(d=_==null?void 0:_.current)!=null?d:g.last(e,[])[1]})}).catch(console.error)},b=(p,T)=>{const _=[...p.files].filter(f=>/image\/*/.test(f.type));_.length>0&&h(_,T)};return{renderElement:p=>{const T=this.customElementMap.get(p.element.type);return T?T.render(e,p):(console.warn(`${p.element.type} not impl`),y.exports.createElement("div",p.attributes,p.children))},renderLeaf:p=>this.textConfig?this.textConfig.render(e,p):y.exports.createElement("span",p.attributes,p.children),decorate:c,onDOMBeforeInput:p=>{it(e,()=>{switch(console.log(p.inputType),p.inputType){case"insertText":n(p);break;case"deleteContentBackward":s(p);break;case"insertParagraph":i(p);break}})},onKeyDown:p=>{it(e,()=>{if(Te("tab",p)){o(p);return}if(Te(["ctrl+enter"],p)){m.insertText(e,`
`);return}})},onSelect:p=>{const T=window.getSelection();T&&(T.isCollapsed?e.hideSelectionToolbar():T.rangeCount>0&&e.updateSelectionToolbar(T.getRangeAt(0)))},onBlur:p=>{e.hideSelectionToolbar()},onClick:()=>{},onPaste:p=>{const T=p.clipboardData;!T||b(T,e.selection)},onDrop:p=>{b(p.dataTransfer,Q.findEventRange(e,p))}}}createDefaultChildren(e){return[]}}function an(t,e){return e.offset===0&&!k.hasPrevious(e.path)&&F.isText(x.get(t,e.path))}function it(t,e){let n=!0;g.withoutNormalizing(t,()=>{e(()=>{n=!1})}),n||g.normalize(t)}U.add(le);const q=B({type:"blockquote",isInline:!1,isLeaf:!1,wrappingParagraph:!0,contentType:S.flow,contentModelType:S.flow,render:(t,{children:e,attributes:n})=>u("blockquote",O(N({},n),{children:e})),toggle:{prefix:/^>$/,toggle:(t,e,n)=>n?t.runAction("indent-blockquote",e):!1,onTrigger(){return!0}},events:{onStartDelete:(t,e)=>{const n=x.parent(t,k.parent(e));return R(n,"blockquote")?t.runAction("outdent-blockquote",k.parent(e)):!1}}});var ln=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:q});const cn=t=>{let e=!1,n=!1;const r=()=>{e=!0,t.preventDefault()},s=()=>{n=!0,t.stopPropagation()};return{nativeEvent:t,currentTarget:t.currentTarget,target:t.target,bubbles:t.bubbles,cancelable:t.cancelable,defaultPrevented:t.defaultPrevented,eventPhase:t.eventPhase,isTrusted:t.isTrusted,preventDefault:r,isDefaultPrevented:()=>e,stopPropagation:s,isPropagationStopped:()=>n,persist:()=>{},timeStamp:t.timeStamp,type:t.type}};function K(t,e,n){let r=t[e];return typeof r=="function"&&(Object.prototype.hasOwnProperty.call(t,e)||(r=r.bind(t))),t[e]=n(r),t}var M;(function(t){t.selection="selection",t.phrasing="phrasing",t.toplevel="toplevel"})(M||(M={}));function un({key:t,type:e,tips:n,defaultParams:r={},action:s,computeState:i,hotkeys:a,icon:o}){const l=N({active:!1,disabled:!1},r),c={key:t,type:e,hotkeys:a!=null?a:[],tips:n!=null?n:null,icon:o!=null?o:null,computeState:i!=null?i:()=>l,action:(h,b,w)=>{const E=c.computeState(h,b);return console.log("run action",t,b,E),E.disabled?!1:s(h,b,E,w)}};return c}function de(t,e,n){const r=n!=null?n:t.selection;if(!!r)switch(e){case M.phrasing:{const s=g.path(t,r),i=x.get(t,s);if(t.getContentModelType(i)===S.phrasing||!F.isText(i)&&t.getContentType(i)===S.flow)return s;for(const[o,l]of x.ancestors(t,s))if(t.getContentModelType(o)===S.phrasing)return l;break}case M.selection:return g.range(t,r);case M.toplevel:{const s=g.path(t,r);if(s.length>=1)return[s[0]];break}}}function pn(t){t.actions=[],t.actionMap=new Map,t.actionTypes={[M.selection]:[],[M.phrasing]:[],[M.toplevel]:[]};const e=new Map;t.defineAction=n=>{const r=un(n);t.actionMap.set(r.key,r),t.actionTypes[r.type].push(r),t.actions.push(r);for(const s of r.hotkeys)e.set(s,r.key)},t.actionHotKeysHas=n=>{for(const r of e.keys())if(Te(r,n))return r},t.onWrapEditor(n=>{n.runAction=(r,s,i)=>{const a=t.actionMap.get(r);if(!a||(s=de(n,a.type,s),!s))return!1;const o=s;let l;return g.withoutNormalizing(n,()=>{l=a.action(n,o,i!=null?i:cn(new Event("fake")))}),l},n.getActions=(r,s)=>{let i=t.actions;s&&(i=s.map(o=>t.actionMap.get(o)).filter(o=>!!o));const a={[M.toplevel]:de(n,M.toplevel,r),[M.selection]:de(n,M.selection,r),[M.phrasing]:de(n,M.phrasing,r)};return i.map(o=>{const l=a[o.type];return{state:l?o.computeState(n,l):{active:!1,disabled:!0},action:o}})}}),K(t,"createDefaultEditableProps",n=>r=>K(n(r),"onKeyDown",s=>i=>{const a=t.actionHotKeysHas(i);if(a&&r.runAction(a,void 0,i)){i.preventDefault(),i.stopPropagation();return}s==null||s(i)})),t.lineActions||(t.lineActions=[["toggle-heading-1","toggle-heading-2","toggle-heading-3","toggle-heading-4","toggle-heading-5","toggle-heading-6"],["toggle-ordered-list","toggle-unordered-list","indent-list","outdent-list"],["toggle-blockquote","toggle-codeblock","toggle-table"]]),t.selectionActions||(t.selectionActions=[A.strong,A.emphasis,A.delete,A.inlineCode,"toggle-link","table-insert-row-right","table-insert-row-left","table-insert-row-above","table-insert-row-below"])}function fn(t){t.defineAction({key:"toggle-blockquote",icon:u(z,{icon:le}),type:M.phrasing,computeState:(e,n)=>{const r=[x.get(e,n),n],s=e.nearest(r,q),i=!!s;let a;return s?a=!e.canUnwrap(s,[q]):a=!e.canToggle(r,q,!1),{active:i,disabled:a,blockquoteEntry:s}},action:(e,n,r)=>{if(r.active){if(r.blockquoteEntry)return e.unwrap(r.blockquoteEntry,[q])}else return e.toggle([x.get(e,n),n],q,void 0);return!1}}),t.defineAction({key:"indent-blockquote",icon:u(z,{icon:le}),type:M.phrasing,computeState:(e,n)=>({active:!1,disabled:!e.canToggle([x.get(e,n),n],q,!1)}),action:(e,n)=>e.toggle([x.get(e,n),n],q,void 0)}),t.defineAction({key:"outdent-blockquote",icon:u(z,{icon:le}),type:M.phrasing,computeState:(e,n)=>{const r=[x.get(e,n),n],s=e.nearest(r,q),i=!!s,a=!s||!e.canUnwrap(s,[q]);return{active:i,disabled:a,blockquoteEntry:s}},action:(e,n,r)=>r.blockquoteEntry?e.unwrap(r.blockquoteEntry,[q]):!1})}var dn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:fn});function gn(t){t.defineAction({key:"toggle-codeblock",type:M.phrasing,icon:u(z,{icon:ie}),computeState:(e,n)=>{const r=x.get(e,n),s=R(r,"code");let i;if(s)i=!1;else{const a=x.parent(e,n),o=e.getContentModelType(a);o?i=!G(rt.contentType,o):i=!0}return{active:s,disabled:i}},action:(e,n,r)=>{const s=x.get(e,n);if(r.active)m.unsetNodes(e,Object.keys(x.extractProps(s)),{at:n}),m.setNodes(e,{type:"paragraph"},{at:n});else{const i=x.string(s);m.removeNodes(e,{at:n}),m.insertNodes(e,{type:"code",lang:"markdown",meta:void 0,children:[{text:i}]},{at:n,select:!0})}return!0}})}var hn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:gn});const ge=B({type:"heading",isInline:!1,isLeaf:!1,wrappingParagraph:!1,contentType:S.flow,contentModelType:S.phrasing,render:(t,{element:e,children:n,attributes:r})=>u(ee,{element:e,children:({active:s})=>y.exports.createElement(`h${e.depth}`,Object.assign(r,{className:Z({active:s})}),n)}),toggle:{prefix:/^#{1,6}$/,estimatePrefixLength:6,toggle:(t,e,n)=>{n?t.runAction(`toggle-heading-${n.depth}`,e):t.runAction("toggle-paragraph",e)},onTrigger:t=>({depth:t.length})},events:{onInsertParagraph:t=>{if(!t.selection)return!1;const e=g.point(t,t.selection),n=k.parent(g.path(t,t.selection));return g.isStart(t,e,n)?t.runAction("toggle-paragraph",n):g.isEnd(t,e,n)?t.runAction("insert-paragraph",k.next(n)):(m.splitNodes(t,{at:t.selection}),t.runAction("toggle-paragraph",k.next(n)))}}});var mn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ge});U.add(_e);const J=B({type:"paragraph",isLeaf:!1,isInline:!1,wrappingParagraph:!1,contentType:S.flow,contentModelType:S.phrasing,toggle:{},events:{},render(t,{element:e,attributes:n,children:r}){return u(ee,{element:e,children:({active:s})=>u("p",O(N({className:Z({active:s})},n),{children:r}))})}});var yn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:J});function bn(t){[1,2,3,4,5,6].forEach(e=>{const n=`H${e}`;t.defineAction({key:`toggle-heading-${e}`,type:M.phrasing,defaultParams:{depth:e},icon:u("span",{children:n}),computeState:(r,s)=>{const i=[x.get(r,s),s],a=r.nearest(i,ge),o=!!a&&a[0].depth===e;let l;return a?l=!r.canToggle(a,J,!1):l=!r.canToggle(i,ge,!0),{active:o,disabled:l,depth:e}},action:(r,s,i)=>{const a=[x.get(r,s),s];return i.active?r.toggle(a,J,void 0):r.toggle(a,ge,{depth:e})}})})}var vn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:bn});function lt(t,e){e&&(typeof e=="function"?e(t):e.current=t)}function xn(t,e){return n=>{lt(n,t),lt(n,e)}}const Re=y.exports.forwardRef(function(s,r){var{children:t,attributes:i}=s,a=i,{ref:e}=a,n=be(a,["ref"]);return u("span",O(N({className:"void-element",contentEditable:!1,ref:xn(r,e)},n),{children:t}))});Re.displayName="VoidElement";U.add(He);const ct=B({type:"image",isInline:!0,isLeaf:!1,contentType:S.staticPhrasing,contentModelType:null,render:(t,{element:e,attributes:n,children:r})=>$(Re,{attributes:n,children:[u("img",{alt:e.alt,src:e.url,title:e.title}),r]}),insert:(t,e,n)=>{m.insertNodes(t,[{text:" "},N({type:"image",children:[]},n),{text:" "}],{at:e})}});var wn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ct});function Tn({schema:t,onSubmit:e,defaultValues:n}){return u("div",{contentEditable:!1,children:u(kt,{className:"action-form",formData:n,onSubmit:r=>e(r.formData),schema:t})})}function _n(t,e){return y.exports.useCallback(()=>t.selection?Q.toDOMRange(t,t.selection).getBoundingClientRect():e.getBoundingClientRect(),[t,e])}function Sn(t,e){return y.exports.useCallback(()=>{t("user canceled"),e.current&&e.current.hide()},[t])}function En(){const t=y.exports.useRef(),e=y.exports.useCallback(n=>{t.current=n},[t]);return[t,e]}function kn(t,e,n,r){const s=y.exports.useCallback(i=>{var a;e(i),(a=r.current)==null||a.hide()},[e,r]);return y.exports.useMemo(()=>u(Tn,{defaultValues:n,onSubmit:s,schema:t}),[t,s])}function Mn({editor:t,el:e,reject:n,resolve:r,schema:s,defaultValues:i}){const[a,o]=En(),l=_n(t,e),c=Sn(n,a),h=kn(s,r,i,a);return u(ae,{content:h,getReferenceClientRect:l,interactive:!0,onClickOutside:c,onMount:o,placement:"right-start",visible:!0,children:u("span",{})})}function Oe(t,e,n,r){return new Promise((s,i)=>{t.setActionForm(u(Mn,{defaultValues:r,editor:t,el:e,reject:i,resolve:s,schema:n}))}).catch(s=>{if(s==="user canceled")return Promise.resolve(void 0);throw s})}const Cn="\u6DFB\u52A0\u56FE\u7247",Pn="object",Nn={src:{title:"\u94FE\u63A5",type:"string",format:"url"},alt:{title:"\u66FF\u4EE3\u6587\u672C\uFF08alt\uFF09",type:"string"}},An=["src","alt"];var Rn={title:Cn,type:Pn,properties:Nn,required:An};function On(t){t.defineAction({key:"toggle-image",type:M.selection,icon:u(z,{icon:He}),computeState:(e,n)=>{const r=Ne(e,n,"image"),s=!k.equals(k.parent(n.focus.path),k.parent(n.anchor.path))||!fe(e,n);return{active:r,disabled:s}},action:(e,n,r,s)=>{if(r.active)return m.unwrapNodes(e,{at:g.unhangRange(e,n),match:i=>!g.isEditor(i)&&I.isElement(i)&&i.type==="image"}),!0;{const i=g.rangeRef(e,n);return Oe(e,s.target,Rn,{alt:g.string(e,n),src:""}).then(a=>{if(!!i.current&&a){const{src:o,alt:l}=a;g.withoutNormalizing(e,()=>{ct.insert(e,n,{url:o,title:"",alt:l})})}}).finally(()=>{i.unref()}),!1}}})}var Dn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:On});const In="\u6DFB\u52A0\u8D85\u94FE\u63A5",zn="object",Bn={src:{title:"\u94FE\u63A5",type:"string",format:"url"},text:{title:"\u663E\u793A\u6587\u672C",type:"string"}},Ln=["src","text"];var Fn={title:In,type:zn,properties:Bn,required:Ln};function $n(t){t.defineAction({key:"toggle-link",type:M.selection,icon:u(z,{icon:qe}),computeState:(e,n)=>{const r=Ne(e,n,"link"),s=!k.equals(k.parent(n.focus.path),k.parent(n.anchor.path))||!fe(e,n);return{active:r,disabled:s}},action:(e,n,r,s)=>{if(r.active)return m.unwrapNodes(e,{at:g.unhangRange(e,n),match:i=>!g.isEditor(i)&&I.isElement(i)&&i.type==="link"}),!0;{const i=g.rangeRef(e,n);return Oe(e,s.target,Fn,{text:g.string(e,n),src:""}).then(a=>{if(!!i.current&&a){const{src:o,text:l}=a;g.withoutNormalizing(e,()=>{Ae.insert(e,n,{url:o,title:"",text:l})})}}).finally(()=>{i.unref()}),!1}}})}var jn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:$n});U.add(We,Ue);const V=B({type:"listItem",isLeaf:!1,isInline:!1,wrappingParagraph:!0,contentType:S.list,contentModelType:S.flow,normalize:(t,e,n,r)=>{if(e.children.length>0)if(R(e.children[0],"list")){m.moveNodes(t,{at:n.concat(0),to:k.parent(n)}),r();return}else{const a=e.children.length-1;if(e.children.length>1&&R(e.children[a],"paragraph")){const o=k.next(n);m.moveNodes(t,{at:n.concat(a),to:o}),m.wrapNodes(t,{type:"listItem",checked:e.checked,spread:e.spread,children:[]},{at:o}),r();return}}else{m.removeNodes(t,{at:n}),r();return}const s=x.parent(t,n);t.getContentModelType(s)!==S.list&&(m.wrapNodes(t,{type:"list",ordered:!1,start:void 0,spread:void 0,children:[]},{at:n}),r())},render(t,{element:e,attributes:n,children:r}){return u("li",O(N({},n),{children:r}))},toggle:{},events:{onStartDelete:(t,e)=>t.runAction("outdent-list",k.parent(e)),onStartEnter:(t,e)=>x.string(x.get(t,e))?!1:t.runAction("outdent-list",k.parent(e)),onTab:(t,e)=>t.runAction("indent-list",k.parent(e))}});var qn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:V});U.add(Ve,Qe);const H=B({type:"list",isLeaf:!1,isInline:!1,wrappingParagraph:!0,contentType:S.flow,contentModelType:S.list,normalize:(t,e,n,r)=>{if(e.children.length===0){m.removeNodes(t,{at:n}),r();return}if(k.hasPrevious(n)){const s=x.get(t,k.previous(n));if(R(s,"list")&&Boolean(s.ordered)===Boolean(e.ordered)&&s.start===void 0&&e.start===void 0){m.mergeNodes(t,{at:n}),r();return}}},render(t,{element:e,attributes:n,children:r}){return e.ordered?u("ol",O(N({},n),{start:e.start,children:r})):u("ul",O(N({},n),{children:r}))},toggle:{prefix:/^(?:-|\d+\.)$/,toggle:(t,e,n)=>{if(n===!1)throw new Error("should never reach");{let r;return t.runActionParams=n,t.nearest([x.get(t,e),e],H)?r=t.runAction("indent-list",e):r=t.runAction(`toggle-${n.ordered?"ordered":"unordered"}-list`,e),t.runActionParams=void 0,r}},onTrigger:t=>{if(t==="-")return{ordered:!1,start:void 0,spread:void 0};{const e=parseInt(t);return{ordered:!0,start:e===1?void 0:e,spread:void 0}}}},events:{}});var Hn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:H});const ut=t=>{let e,n;if(t.runActionParams&&typeof t.runActionParams=="object"){const{ordered:r,start:s}=t.runActionParams;typeof r=="boolean"&&(e=r),typeof s=="number"&&(n=s)}return{ordered:e,start:n}};function Wn(t){t.defineAction({key:"indent-list",type:M.phrasing,icon:u(z,{icon:We}),computeState:(e,n)=>{const r=[x.get(e,n),n],s=e.nearest(r,V),i=e.nearest(s!=null?s:r,H),a=!1,o=!i||!s||!k.hasPrevious(s[1])||i[0].children.length<=1;return N({active:a,disabled:o,listEntry:i,listItemEntry:s},ut(e))},action:(e,n,r)=>{var a;const{listEntry:s,listItemEntry:i}=r;return!i||!s?!1:e.wrap(i,[V,H],[{spread:void 0,checked:void 0},{ordered:(a=r.ordered)!=null?a:s[0].ordered,spread:void 0,start:r.start}])?(m.mergeNodes(e,{at:i[1]}),!0):!1}}),t.defineAction({key:"outdent-list",type:M.phrasing,icon:u(z,{icon:Ue}),computeState:(e,n)=>{const r=[x.get(e,n),n],s=e.nearest(r,V),i=e.nearest(s!=null?s:r,H);return{active:!1,disabled:!i||!s,listEntry:i,listItemEntry:s}},action:(e,n,r)=>{const{listEntry:s,listItemEntry:i}=r;if(!i||!s)return!1;const a=g.pathRef(e,i[1]),o=k.next(i[1]);if(g.hasPath(e,o)&&m.splitNodes(e,{at:o}),m.splitNodes(e,{at:i[1]}),a.current){const l=k.parent(a.current),c=[x.get(e,l),l];e.unwrap(c,[H,V]),m.splitNodes(e,{at:l})}return a.unref(),!0}}),[!0,!1].forEach(e=>{const n={ordered:e,spread:void 0,start:void 0},r={spread:void 0,checked:void 0};t.defineAction({key:`toggle-${e?"ordered":"unordered"}-list`,type:M.phrasing,icon:u(z,{icon:e?Ve:Qe}),computeState:(s,i)=>{const a=[x.get(s,i),i],o=s.nearest(a,H),l=o?Boolean(o[0].ordered)===Boolean(e):!1;let c;return o?l?c=!s.canUnwrap(o,[H,V]):c=!0:c=!s.canWrap(a,[H,V],[n,r]),{active:l,disabled:c,listEntry:o}},action:(s,i,a)=>{const o=[x.get(s,i),i],{ordered:l,start:c}=ut(s);return a.listEntry?a.active?s.unwrap(a.listEntry,[H,V]):(m.setNodes(s,{ordered:l,start:c},{at:a.listEntry[1]}),!0):s.wrap(o,[H,V],[Object.assign({},n,{start:c}),r])}})})}var Un=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:Wn});function Vn(t){t.defineAction({key:"toggle-paragraph",type:M.phrasing,icon:u(z,{icon:_e}),computeState:(e,n)=>{const r=[x.get(e,n),n],s=e.nearest(r,J),i=!!s;let a;return s?a=!0:a=!e.canToggle(r,J,!0),{active:i,disabled:a}},action:(e,n,r)=>{const s=[x.get(e,n),n];return r.active?!1:e.toggle(s,J,void 0)}}),t.defineAction({key:"insert-paragraph",type:M.toplevel,icon:u(z,{icon:_e}),computeState:()=>({active:!1,disabled:!1}),action:(e,n,r)=>(m.insertNodes(e,{type:"paragraph",children:[{text:""}]},{at:n,select:!0}),!0)})}var Qn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:Vn});const he=y.exports.createContext({isHeader:!1});var Gn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",TableContext:he});const pt=B({type:"tableCell",isInline:!1,isLeaf:!1,contentType:S.tableRow,contentModelType:S.phrasing,wrappingParagraph:!1,events:{onStartDelete:(t,e)=>!0,onInsertParagraph:(t,e)=>(t.insertText(`
`),!0)},toggle:{},render:(t,{element:e,attributes:n,children:r})=>u(he.Consumer,{children:({isHeader:s})=>s?u("th",O(N({},n),{children:r})):u("td",O(N({},n),{children:r}))})});var Kn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:pt});U.add(Ge);const ft=B({type:"table",isInline:!1,isLeaf:!1,contentType:S.flow,contentModelType:S.table,wrappingParagraph:!1,events:{},toggle:{},render:(t,{element:e,attributes:n,children:r})=>{const[s,...i]=r,a={isHeader:!0,align:e.align},o={isHeader:!1,align:e.align};return u(ee,{element:e,children:$("table",O(N({},n),{children:[u(he.Provider,{value:a,children:u("thead",{children:s})}),u(he.Provider,{value:o,children:u("tbody",{children:i})})]}))})}});var Yn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ft});const Xn=B({type:"tableRow",isInline:!1,isLeaf:!1,contentType:S.table,contentModelType:S.tableRow,wrappingParagraph:!1,events:{},toggle:{},render:(t,{element:e,attributes:n,children:r})=>u("tr",O(N({},n),{children:r}))});var Jn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Xn});const Zn="\u6DFB\u52A0\u56FE\u7247",er="object",tr={cols:{title:"\u5217\u6570",type:"number",min:2},rows:{title:"\u884C\u6570",type:"number",min:2}},nr=["cols","rows"];var rr={title:Zn,type:er,properties:tr,required:nr};const sr=t=>{let e,n;if(t.runActionParams&&typeof t.runActionParams=="object"){const{rows:r,cols:s}=t.runActionParams;typeof r=="boolean"&&(e=r),typeof s=="number"&&(n=s)}return{rows:e,cols:n}},De=t=>t.children.length>0?t.children[0].children.length:0;function dt(t,e,n){let r;return t.selection&&([r]=g.nodes(t,{at:t.selection,mode:"lowest",match:s=>R(s,"tableRow")})),r?r[1]:e.concat(n)}function gt(t,e){let n;if(t.selection){const r=t.selection.focus.path,s=t.nearest([x.get(t,r),r],pt);s&&(n=s[1][s[1].length-1])}return typeof n!="number"&&(n=e),n}function ht(t,e,n){m.insertNodes(t,{type:"tableRow",children:Array(n).fill(0).map(()=>({type:"tableCell",children:[{text:""}]}))},{at:e})}function mt(t,e,n){for(const[r]of Array(e[0].children.length).fill(0).entries()){const s=e[1].concat(r,n);m.insertNodes(t,{type:"tableCell",children:[{text:""}]},{at:s})}}function or(t){t.defineAction({key:"toggle-table",type:M.phrasing,icon:u(z,{icon:Ge}),computeState:(e,n)=>{const r=x.get(e,n),s=R(r,"table");let i,a;if(s)a=!1,i=[r,n];else{const o=x.parent(e,n),l=e.getContentModelType(o);l?a=!G(ft.contentType,l):a=!0}return{active:s,disabled:a,tableEntry:i}},action:(e,n,r,s)=>{if(sr(e),r.active){if(!r.tableEntry)return!1;const[i,a]=r.tableEntry,o=[...x.texts(i)].map(([l])=>l.text).join(" ");return m.removeNodes(e,{at:a}),m.insertNodes(e,{type:"paragraph",children:[{text:o}]},{at:a}),!0}else{const i=g.pathRef(e,n);return Oe(e,s.target,rr,{cols:2,rows:2}).then(a=>{const o=i.current;!o||a&&g.withoutNormalizing(e,()=>{const{cols:l,rows:c}=a;m.removeNodes(e,{at:o}),m.insertNodes(e,{type:"table",align:void 0,children:Array(c).fill(0).map(()=>({type:"tableRow",children:Array(l).fill(0).map(()=>({type:"tableCell",children:[{text:""}]}))}))},{at:o})})}).finally(()=>i.unref()),!0}}}),t.defineAction({key:"table-insert-row-above",type:M.selection,icon:u(Mt,{}),computeState:(e,n)=>{const[r]=g.nodes(e,{at:n,mode:"lowest",match:s=>R(s,"table")});return{active:!1,disabled:!r,tableEntry:r}},action:(e,n,r)=>{if(!r.tableEntry)return!1;const[s,i]=r.tableEntry,a=dt(e,i,0),o=De(s);return ht(e,a,o),!0}}),t.defineAction({key:"table-insert-row-below",type:M.selection,icon:u(Ct,{}),computeState:(e,n)=>{const[r]=g.nodes(e,{at:n,mode:"lowest",match:s=>R(s,"table")});return{active:!1,disabled:!r,tableEntry:r}},action:(e,n,r)=>{if(!r.tableEntry)return!1;const[s,i]=r.tableEntry,a=dt(e,i,s.children.length-1);a[a.length-1]+=1;const o=De(s);return ht(e,a,o),!0}}),t.defineAction({key:"table-insert-row-left",type:M.selection,icon:u(Pt,{}),computeState:(e,n)=>{const[r]=g.nodes(e,{at:n,mode:"lowest",match:s=>R(s,"table")});return{active:!1,disabled:!r,tableEntry:r}},action:(e,n,r)=>{if(!r.tableEntry)return!1;const s=gt(e,0);return mt(e,r.tableEntry,s),!0}}),t.defineAction({key:"table-insert-row-right",type:M.selection,icon:u(Nt,{}),computeState:(e,n)=>{const[r]=g.nodes(e,{at:n,mode:"lowest",match:s=>R(s,"table")});return{active:!1,disabled:!r,tableEntry:r}},action:(e,n,r)=>{if(!r.tableEntry)return!1;const s=gt(e,De(r.tableEntry[0])-1)+1;return mt(e,r.tableEntry,s),!0}})}var ar=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:or});function ir(t){[{key:A.strong,icon:ve,tips:u(ce,{children:"\u52A0\u7C97"}),hotkeys:["meta+b"]},{key:A.emphasis,icon:xe,tips:u(ce,{children:"\u659C\u4F53"}),hotkeys:["meta+i"]},{key:A.inlineCode,icon:ie,tips:u(ce,{children:"\u884C\u5185\u4EE3\u7801"})},{key:A.delete,icon:we,tips:u(ce,{children:"\u5220\u9664"})}].forEach(({icon:e,key:n,tips:r,hotkeys:s})=>{t.defineAction({key:n,type:M.selection,icon:u(z,{icon:e}),tips:r,hotkeys:s,computeState:(i,a)=>{const o=Ce(i,a,n),l=!fe(i,a);return{active:o,disabled:l}},action:(i,a,o,l)=>(Me.toggleDecorator(i,a,n),!0)})})}var lr=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",register:ir}),cr=B({type:"thematicBreak",isLeaf:!1,isInline:!1,wrappingParagraph:!1,contentType:S.flow,contentModelType:null,render(t,{element:e,children:n,attributes:r}){return u(ee,{element:e,children:$(Re,{attributes:r,children:[u("hr",{}),n]})})},toggle:{prefix:/^---$/,estimatePrefixLength:3,toggle:(t,e,n)=>{n?(m.removeNodes(t,{at:e}),m.insertNodes(t,{type:"paragraph",children:[{text:""}]},{at:e}),m.insertNodes(t,{type:"thematicBreak",children:[]},{at:e}),Q.deselect(t),m.select(t,g.start(t,k.next(e)))):m.setNodes(t,{type:"thematicBreak",children:[{text:""}]},{at:e})},onTrigger:(t,e,n)=>{if(!(n.length>1))return!0}},events:{}}),ur=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:cr});const pr={"./blockquote/BlockquoteNode.tsx":ln,"./blockquote/action.tsx":dn,"./code/CodeNode.tsx":tn,"./code/actions.tsx":hn,"./heading/HeadingNode.tsx":mn,"./heading/actions.tsx":vn,"./image/ImageNode.tsx":wn,"./image/action.tsx":Dn,"./link/LinkNode.tsx":rn,"./link/action.tsx":jn,"./list/ListItemNode.tsx":qn,"./list/ListNode.tsx":Hn,"./list/actions.tsx":Un,"./paragraph/ParagraphNode.tsx":yn,"./paragraph/actions.tsx":Qn,"./table/TableCellNode.tsx":Kn,"./table/TableNode.tsx":Yn,"./table/TableRowNode.tsx":Jn,"./table/actions.tsx":ar,"./table/context.tsx":Gn,"./text/TextNode.tsx":nn,"./text/actions.tsx":lr,"./thematic-break/ThematicBreakNode.tsx":ur};function fr(t){for(const[e,{default:n,register:r}]of Object.entries(pr)){const s=r||(n==null?void 0:n.register);typeof s=="function"&&(console.debug("auto detected",e),s(t))}}U.add(ve,xe,we,ie);function yt(t,e){if(!!e)return typeof e=="function"?e(t):e}function dr(t,e){var r;if(!e)return[];const n=(r=Q.toSlateRange(t,e,{exactMatch:!0}))!=null?r:t.selection;if(n){if(!ot(t,n))return[];const[s]=g.nodes(t,{at:n,match:i=>{const a=i.type;if(a){const o=t.factory.customElementMap.get(a);if(o&&o.contentModelType!==S.value)return!0}return!1}});if(!s)return[]}return t.getActions(n!=null?n:void 0,t.factory.selectionActions).map(({action:{key:s,icon:i,tips:a},state:o})=>({key:s,disabled:o.disabled,active:o.active,icon:yt(o,i),tips:yt(o,a),action:l=>{t.runAction(s,n!=null?n:void 0,l)}})).filter(s=>!s.disabled)}function gr(){const t=oe(),e=y.exports.useRef(null),n=y.exports.useRef(),[r,s]=y.exports.useState(!0),i=et(),[a,o]=y.exports.useState([]);t.hideSelectionToolbar=()=>s(!0);const l=y.exports.useMemo(()=>({getBoundingClientRect(){return n.current?n.current.getBoundingClientRect():{width:0,height:0}}}),[t,n]),{styles:c,attributes:h,update:b}=At(l,e.current,{placement:"top",modifiers:[{name:"computeStyles",options:{adaptive:!1}},{name:"offset",options:{offset:[0,8]}}]});return t.updateSelectionToolbar=w=>{if(w){const p=!n.current;n.current=w,p&&setTimeout(()=>{t.updateSelectionToolbar()},0)}const E=dr(t,n.current);o(E),E.length>0?(s(!1),b&&b()):s(!0),i()},t.toggleSelectionToolbar=w=>{r?t.updateSelectionToolbar(w):t.hideSelectionToolbar()},u("div",O(N({className:"ti-hovering-toolbar",ref:e,style:O(N({},c.popper),{opacity:r?0:1,pointerEvents:r?"none":"initial"})},h.popper),{children:a.map(w=>u(Je,{action:w.action,active:w.active,disabled:w.disabled,icon:w.icon,tips:w.tips},w.key))}))}function hr(t){const e=t.createDefaultChildren.bind(t);t.createDefaultChildren=n=>{const r=e(n);return r.push(y.exports.createElement(gr,{key:"selection-toolbar"})),r},t.onWrapEditor(n=>{n.updateSelectionToolbar=n.hideSelectionToolbar=n.toggleSelectionToolbar=()=>{}})}const bt=Rt({proto:!1,circles:!1});function mr(t){const e=[],n=[],r=ue(),s=ue(),i=ue(),a=ue();t.freezeProcessors=()=>{r.use(e).use(Ke).use(pe).use(Ot,{emphasis:"*",strong:"*",listItemIndent:"one",fence:"`",bullet:"-"}).freeze(),s.use(e).use(Ke).use(pe).use(Dt).use(It).freeze(),i.use(zt).use(pe).use(Ye).use(n).freeze(),a.use(Bt).use(Lt).use(pe).use(Ye).use(n).freeze()},t.configProcessor=(...o)=>{t.configSerializeProcessor(...o),t.configDeserializeProcessor(...o)},t.configSerializeProcessor=(...o)=>{e.push(...o)},t.configDeserializeProcessor=(...o)=>{n.push(...o)},t.generateMarkdown=o=>r.stringify(r.runSync({type:"root",children:bt(o)})),t.generateHtml=o=>s.stringify(s.runSync({type:"root",children:bt(o)})),t.parseMarkdown=o=>i.processSync(o).result,t.parseHtml=o=>a.processSync(o).result,K(t,"createDefaultEditableProps",o=>l=>K(o(l),"onPaste",c=>h=>{const b=h.clipboardData;if(b&&b.types.indexOf("application/x-slate-fragment")<0){if(b.types.indexOf("text/html")>=0){const w=b.getData("text/html"),E=t.parseHtml(w);l.insertFragment(E),h.preventDefault();return}else if(b.types.indexOf("text/plain")>=0){const w=b.getData("text/plain"),E=t.parseMarkdown(w);l.insertFragment(E),h.preventDefault();return}}c==null||c(h)})),t.onWrapEditor(o=>{K(o,"insertFragment",l=>c=>{if(o.selection){const h=x.parent(o,o.selection.anchor.path);if(o.getContentModelType(h)===S.value){m.insertText(o,t.generateMarkdown(c));return}}l(c)}),K(o,"setFragmentData",l=>c=>{l(c),c.setData("text/plain",t.generateMarkdown(o.getFragment()))})})}var Y;(function(t){t[t.replace=1]="replace",t[t.wrap=2]="wrap",t[t.unwrap=3]="unwrap",t[t.custom=4]="custom"})(Y||(Y={}));function Ie(t){const e=new on;return e.use(mr),e.use(pn),e.use(hr),fr(e),t&&t(e),e.freezeProcessors(),e}const me=y.exports.forwardRef(({factory:t,disabled:e=!1,initialMarkdown:n="",config:r,uploadFile:s,value:i,onChange:a,children:o},l)=>{const c=y.exports.useMemo(()=>{const d=Ft($t(jt()));return d.onAlert=(v,C)=>{console.warn(v,C)},t.wrapEditor(d)},[t]);y.exports.useEffect(()=>{l&&(typeof l=="function"?l(c):l.current=c)},[c,l]),y.exports.useEffect(()=>{n&&(c.markdown=n)},[c]);const h=y.exports.useMemo(()=>t.createDefaultEditableProps(c),[t,c]),b=y.exports.useRef(null),w=y.exports.useMemo(()=>({getEditorDOMRect(){var d,v;return(v=(d=b.current)==null?void 0:d.getBoundingClientRect())!=null?v:new DOMRect}}),[b]),[E,p]=y.exports.useState();c.setActionForm=p,s&&(c.uploadFile=s);const T=y.exports.useMemo(()=>{if(E)return qt.exports.createPortal(E,document.body)},[E]),_=y.exports.useCallback(d=>{a(d)},[a]);y.exports.useEffect(()=>{t.triggerEditorMounted(c)},[c]);const f=y.exports.useMemo(()=>t.createDefaultChildren(c),[t,c]);return $(Ht,{editor:c,onChange:_,value:i,children:[f,$(tt.Provider,{value:w,children:[u("div",{className:"ti-community-editor-container",ref:b,children:u(Wt,N({as:"article",className:"ti-community-editor markdown-body",readOnly:e},h))}),o]}),T]})});me.displayName="TiEditor";var yr=B({type:"section",isLeaf:!1,isInline:!1,isEditable:!1,contentType:S.flow,contentModelType:S.flow,wrappingParagraph:!1,normalize:(t,e,n,r)=>{e.children.length===0&&(m.removeNodes(t,{at:n}),r())},render(t,{attributes:e,children:n}){return u("section",O(N({},e),{children:n}))},events:{},toggle:{}});const br=()=>t=>{Ut(t,n=>"children"in n&&"type"in n,n=>{for(let r=n.children.length-1;r>=0;--r){const s=n.children[r];s.type==="section"&&n.children.splice(r,1,...s.children)}})};function vr(t,e,n){for(const r of e)if((Xe.isNodeOperation(r)||Xe.isTextOperation(r))&&j.includes(n,r.path))return!0;return!1}function ne({section:t,value:e=[],onChange:n}){const r=oe(),s=y.exports.useRef(n),i=y.exports.useRef([]);return s.current=n,y.exports.useEffect(()=>{const a=r.factory.registerOnChange(()=>{const l=r.getSectionRange(t);if(!!l&&vr(r,r.operations,l)){const c=r.getSection(t);i.current=c,s.current(c)}}),o=r.factory.registerOnSectionLayout(l=>{t===l&&e!==i.current&&(i.current=e,r.setSection(t,e))});return()=>{a(),o()}},[r]),y.exports.useEffect(()=>{e!==i.current&&r.setSection(t,e)},[e]),null}function vt(t){yr.register(t),t.configSerializeProcessor(br);let e=[];t.configSections=a=>{e=a};const n=new WeakMap;t.onWrapEditor(a=>{const{normalizeNode:o,deleteFragment:l,deleteBackward:c,deleteForward:h,insertFragment:b,runAction:w,onChange:E,insertText:p,insertBreak:T}=a,_=[];n.set(a,_),a.insertFragment=f=>{b(f.filter(d=>!R(d,"section")))},a.runAction=(f,d,v)=>{if(d){const C=g.range(a,d);let P=!1;for(const D of _)if(D.current&&j.includes(C,D.current)){P=!0;break}if(P)return a.onAlert("\u65E0\u6CD5\u64CD\u4F5C\u56FA\u5B9A\u5185\u5BB9",""),!1}return w(f,d,v)},a.deleteFragment=f=>{if(a.selection){let d=!1;for(const v of _)if(v.current&&j.includes(a.selection,v.current)){d=!0;break}if(d){a.onAlert("\u65E0\u6CD5\u5220\u9664\u56FA\u5B9A\u5185\u5BB9","");return}}l(f)},a.deleteBackward=f=>{if(a.selection){const d=g.before(a,a.selection,{unit:f});if(d&&R(g.node(a,d,{depth:1})[0],"section")){a.onAlert("\u65E0\u6CD5\u5220\u9664\u56FA\u5B9A\u5185\u5BB9","");return}}c(f)},a.deleteForward=f=>{if(a.selection){const d=g.after(a,a.selection,{unit:f});if(d&&R(g.node(a,d,{depth:1})[0],"section")){a.onAlert("\u65E0\u6CD5\u5220\u9664\u56FA\u5B9A\u5185\u5BB9","");return}}h(f)},a.normalizeNode=f=>{o(f)},Object.defineProperty(a,"markdown",{get(){console.warn("editor.markdown was disabled for layout plugin, use editor.getSectionMarkdown instead")},set(){console.warn("editor.markdown was disabled for layout plugin, use editor.setSectionMarkdown instead")}}),a.getSectionSpan=f=>{if(f>=_.length)return;let d=_[f].current;if(!d)return;let v;if(f<_.length-1?v=_[f+1].current:v=[a.children.length-1],!!v&&(d=k.next(d),k.hasPrevious(v)?v=k.previous(v):v=d,k.isBefore(v,d)&&(v=d),!(!g.hasPath(a,d)||!g.hasPath(a,v))))return[d,v]},a.getSectionRange=f=>{const d=a.getSectionSpan(f);if(!d)return;const[v,C]=d,P=g.start(a,v),D=g.end(a,C);return{anchor:P,focus:D}},a.getSection=f=>{const d=a.getSectionSpan(f);if(!d)return[];const[...v]=g.nodes(a,{at:d,mode:"highest",match:C=>!g.isEditor(C)});return v.map(([C])=>C)},a.getSectionMarkdown=f=>t.generateMarkdown(a.getSection(f)),a.setSection=(f,d)=>{const v=a.getSectionRange(f);!v||(m.select(a,v),a.insertFragment(d))},a.setSectionMarkdown=(f,d)=>{a.setSection(f,t.parseMarkdown(d))},a.onChange=()=>{E(),Object.values(s).forEach(f=>f())},a.onSectionLayout=f=>{Object.values(i).forEach(d=>d(f))}}),t.onEditorMounted(a=>{const o=n.get(a);if(!o)throw new Error;const l=(c,h)=>(m.insertNodes(a,[c,{type:"paragraph",children:[{text:""}]}],{at:[h*2]}),g.pathRef(a,[h*2]));Se.withoutSaving(a,()=>{g.withoutNormalizing(a,()=>{if(e.length&&o.length===0){for(let c=0;c<e.length;++c)o[c]=l(e[c],c);return}})});for(let c=0;c<e.length;++c)a.onSectionLayout(c)});let r=0;const s={},i={};t.registerOnChange=a=>{const o=++r;return s[o]=a,()=>{delete s[r]}},t.registerOnSectionLayout=a=>{const o=++r;return i[o]=a,()=>{delete i[r]}},K(t,"createDefaultEditableProps",a=>o=>K(a(o),"onKeyDown",l=>c=>{if((!c.metaKey||t.actionHotKeysHas(c))&&o.selection){let h=!1;for(const b of n.get(o)||[])if(b.current&&j.intersection(o.selection,g.range(o,b.current))){h=!0;break}if(h){o.onAlert("\u65E0\u6CD5\u7F16\u8F91\u56FA\u5B9A\u5185\u5BB9",""),c.preventDefault(),c.stopPropagation();return}}l==null||l(c)}))}const xr=`# a-editor

## \u6280\u672F\u6808

- core
  - [slate](https://www.slatejs.org/)
  - [remark](https://remark.js.org/)
  - [remark-slate-transformer](https://github.com/inokawa/remark-slate-transformer)
- code highlight
  - [prism](https://prismjs.com/)

## \u6837\u5F0F\u914D\u7F6E

### \u4EE3\u7801\u9AD8\u4EAE

\u5728 \`src/slate-markdown/elements/code/style.less\` \u6DFB\u52A0\u5BF9\u5E94 token \u6837\u5F0F\u3002

abc
deb

## \u7528\u6CD5
`,wr={},Tr=xr+`

`+Object.values(wr).map(t=>t.plainText).join(`

`);function _r(t){t.use(vt),t.configSections([{type:"section",children:[{type:"heading",depth:1,children:[{text:"section 1",inlineCode:!0},{text:" \u65E0\u6CD5\u4FEE\u6539\u6216\u5220\u9664\uFF0C\u4F7F\u7528\u65B9\u6CD5\u67E5\u770B "},{text:"plugins/layout",inlineCode:!0}]},{type:"blockquote",children:[{type:"paragraph",children:[{text:"\u7528\u4E8E\u56FA\u5B9A\u7684\u5185\u5BB9\u7ED3\u6784"}]}]}]},{type:"section",children:[{type:"heading",depth:1,children:[{text:"section 2",inlineCode:!0}]}]}]),t.onEditorMounted(e=>{setTimeout(()=>{Se.withoutSaving(e,()=>{e.setSectionMarkdown(0,"write something here"),e.setSectionMarkdown(1,Tr)})})})}async function Sr(t){return new Promise((e,n)=>{const r=new FileReader;r.onloadend=function(){setTimeout(()=>{e(r.result)},500)},r.onerror=function(){n(r.error)},r.readAsDataURL(t)})}const Er=Ie(_r);function kr(){const[t,e]=y.exports.useState([]),n=y.exports.useCallback(o=>{e(o)},[t]),[r,s]=y.exports.useState([]),[i,a]=y.exports.useState([]);return u("div",{children:$(me,{factory:Er,onChange:n,uploadFile:Sr,value:t,children:[u(ne,{onChange:s,section:0,value:r}),u(ne,{onChange:a,section:1,value:i})]})})}async function Mr(t){return new Promise((e,n)=>{const r=new FileReader;r.onloadend=function(){setTimeout(()=>{e(r.result)},500)},r.onerror=function(){n(r.error)},r.readAsDataURL(t)})}const Cr=Ie();function Pr(){const[t,e]=y.exports.useState([{type:"paragraph",children:[{text:"here to input"}]}]),n=y.exports.useCallback(r=>{e(r)},[t]);return u("div",{children:u(me,{factory:Cr,onChange:n,uploadFile:Mr,value:t})})}function Nr(t){t.use(vt),t.configSections([{type:"section",children:[{type:"heading",depth:1,children:[{text:"section 1",inlineCode:!0}]},{type:"blockquote",children:[{type:"paragraph",children:[{text:"\u7528\u4E8E\u56FA\u5B9A\u7684\u5185\u5BB9\u7ED3\u6784"}]}]}]},{type:"section",children:[{type:"heading",depth:1,children:[{text:"section 2",inlineCode:!0}]}]},{type:"section",children:[{type:"heading",depth:1,children:[{text:"section 3",inlineCode:!0}]}]}]),t.onEditorMounted(e=>{setTimeout(()=>{Se.withoutSaving(e,()=>{e.setSectionMarkdown(0,"write something here"),e.setSectionMarkdown(1,"write something here"),e.setSectionMarkdown(2,"write something here")})})})}async function Ar(t){return new Promise((e,n)=>{const r=new FileReader;r.onloadend=function(){setTimeout(()=>{e(r.result)},500)},r.onerror=function(){n(r.error)},r.readAsDataURL(t)})}const Rr=Ie(Nr);function Or(){const[t,e]=y.exports.useState([]),n=y.exports.useCallback(c=>{e(c)},[t]),[r,s]=y.exports.useState([]),[i,a]=y.exports.useState([]),[o,l]=y.exports.useState([]);return u("div",{children:$(me,{factory:Rr,onChange:n,uploadFile:Ar,value:t,children:[u(ne,{onChange:s,section:0,value:r}),u(ne,{onChange:a,section:1,value:i}),u(ne,{onChange:l,section:2,value:o})]})})}Vt.render(u(Qt.StrictMode,{children:u(Gt,{basename:"https://634750802.github.io/a-editor/",children:$("div",{children:[$("nav",{children:[u(Ee,{to:"/",children:"Full example"}),u(Ee,{to:"/empty",children:"Empty example"}),u(Ee,{to:"/sections",children:"Sections example"})]}),u("main",{children:$(Kt,{children:[u(ke,{component:Pr,exact:!0,path:"/empty"}),u(ke,{component:Or,exact:!0,path:"/sections"}),u(ke,{component:kr,path:"/"})]})})]})})}),document.getElementById("root"));
