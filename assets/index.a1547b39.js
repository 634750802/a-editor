var A=Object.defineProperty,K=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var L=(t,e,n)=>e in t?A(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,g=(t,e)=>{for(var n in e||(e={}))J.call(e,n)&&L(t,n,e[n]);if(j)for(var n of j(e))Q.call(e,n)&&L(t,n,e[n]);return t},x=(t,e)=>K(t,G(e));var k=(t,e,n)=>(L(t,typeof e!="symbol"?e+"":e,n),n);import{r as _,u as D,p as U,a as W,b as X,c as Y,d as Z,E as M,e as E,_ as F,T as c,N as p,R as O,f as B,P as i,j as u,w as ee,g as te,h as ne,S as re,i as se,k as V,l as q,F as oe,m as ae,n as ie}from"./vendor.2d99855d.js";const le=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}};le();class ce{constructor(e,n){k(this,"getMarkdownProcessor",D().use(U).use(W,{bullet:"-",listItemIndent:"one",fence:"`",rule:"-"}));k(this,"setMarkdownProcessor",D().use(X).use(Y).use(Z));this.editor=e,this.setValue=n,this.getMarkdownProcessor.freeze(),this.setMarkdownProcessor.freeze()}get markdown(){return this.getMarkdownProcessor.stringify(this.getMarkdownProcessor.runSync({type:"root",children:this.editor.children}))}set markdown(e){this.setValue(this.setMarkdownProcessor.processSync(e).result),setTimeout(()=>{M.normalize(this.editor,{force:!0})},0)}}function ue(t){const[e,n]=_.exports.useState([{type:"paragraph",children:[{text:""}]}]);return[_.exports.useMemo(()=>new ce(t,n),[t]),e,n]}class de{constructor(){k(this,"blockConfigs",[]);k(this,"inlineConfigs",[]);k(this,"textConfig");k(this,"inlineSet",new Set);k(this,"voidSet",new Set);k(this,"customElementMap",new Map)}define(e){return e.isLeaf?this.textConfig=e:(e.isInline?(this.inlineSet.add(e.type),this.inlineConfigs.push(e)):this.blockConfigs.push(e),this.customElementMap.set(e.type,e),e.isVoid&&this.voidSet.add(e.type)),this}wrapEditor(e){const{isVoid:n,isInline:o,normalizeNode:r}=e;return e.isVoid=a=>this.voidSet.has(a.type)||n(a),e.isInline=a=>this.inlineSet.has(a.type)||o(a),e.normalizeNode=a=>{let h=!0;M.withoutNormalizing(e,()=>{var l;const[P,s]=a;if(E.isElement(P)){const m=(l=this.customElementMap.get(P.type))==null?void 0:l.normalize;m&&m(e,P,s,()=>{h=!1})}}),h&&r(a)},e}createDefaultEditableProps(e){const n=s=>{var m;const{selection:l}=e;if(l&&O.isCollapsed(l)){const f=l.anchor,N=p.get(e,f.path),y=p.parent(e,f.path);if(B.isText(N)&&E.isElement(y)&&y.type==="paragraph"&&s.data===" "&&!i.hasPrevious(f.path)){const w=N.text.slice(0,f.offset);for(const{toggle:d}of this.blockConfigs)if(!(typeof d.estimatePrefixLength=="number"&&w.length>d.estimatePrefixLength)&&(console.log(d.prefix,"go",this.blockConfigs),(m=d.prefix)==null?void 0:m.test(w))){console.log(d.prefix,"go");const b=d.onTrigger(w);if(typeof b!="undefined"){c.delete(e,{at:{path:f.path,offset:0},distance:f.offset}),d.toggle(e,i.parent(f.path),b),s.preventDefault();return}}}}},o=s=>l=>{const{selection:m}=e;if(m&&O.isCollapsed(m)){const f=m.anchor;if(pe(e,f)){const N=i.parent(f.path),y=p.get(e,N);if(E.isElement(y)){const w=this.customElementMap.get(y.type);if(w){const d=s(w.events);if(d&&d(e,f.path)){l.preventDefault();return}}if(y.type==="paragraph"){const d=p.parent(e,N);if(!i.hasPrevious(N)&&E.isElement(d)){const b=this.customElementMap.get(d.type);if(b==null?void 0:b.wrappingParagraph){const S=s(b.events);if(S&&S(e,f.path)){l.preventDefault();return}}}}}}}},r=o(s=>s.onStartDelete),a=o(s=>s.onStartEnter),P=(s=>l=>{const{selection:m}=e;if(m&&O.isCollapsed(m)){const f=m.anchor,N=i.parent(f.path),y=p.parent(e,f.path);if(E.isElement(y)){const w=this.customElementMap.get(y.type);if(w){const d=s(w.events);if(d&&d(e,f.path)){l.preventDefault();return}}if(y.type==="paragraph"){const d=p.parent(e,N);if(E.isElement(d)){const b=this.customElementMap.get(d.type);if(b==null?void 0:b.wrappingParagraph){const S=s(b.events);if(S&&S(e,f.path)){l.preventDefault();return}}}}}}})(s=>s.onTab);return{renderElement:s=>{const l=this.customElementMap.get(s.element.type);return l?l.render(e,s):(console.warn(`${s.element.type} not impl`),_.exports.createElement("div",s.attributes,s.children))},renderLeaf:s=>this.textConfig?this.textConfig.render(e,s):_.exports.createElement("span",s.attributes,s.children),onDOMBeforeInput:s=>{$(e,()=>{switch(console.log(s.inputType),s.inputType){case"insertText":n(s);break;case"deleteContentBackward":r(s);break;case"insertParagraph":a(s);break;case"insertFromPaste":console.log(s);break}})},onKeyDown:s=>{$(e,()=>{if(F("tab",s)&&P(s),F(["ctrl+enter"],s)&&c.insertText(e,`
`),F("enter",s)&&e.selection){const l=p.parent(e,e.selection.anchor.path);M.isBlock(e,l)&&(/paragraph|heading/.test(l.type)||(c.insertText(e,`
`),s.preventDefault()))}})}}}}function pe(t,e){return e.offset===0&&!i.hasPrevious(e.path)&&B.isText(p.get(t,e.path))}function $(t,e){let n=!0;M.withoutNormalizing(t,()=>{e(()=>{n=!1})}),n||M.normalize(t)}function T(t){return x(g({},t),{register(e){e.define(t)}})}function v(t,e){return E.isElement(t)&&t.type===e}function fe(t,e){const n=i.previous(e),o=p.get(t,n);return n.concat(o.children.length)}const R=T({type:"blockquote",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!0,render:(t,{children:e,attributes:n})=>u("blockquote",x(g({},n),{children:e})),toggle:{prefix:/^>$/,toggle:(t,e,n)=>{n?c.wrapNodes(t,{type:"blockquote",children:[]},{at:e}):c.unwrapNodes(t,{at:i.parent(e)})},onTrigger(){return!0}},events:{onStartDelete:(t,e)=>{const n=p.parent(t,i.parent(e));return v(n,"blockquote")?(R.toggle.toggle(t,i.parent(e),!1),!0):!1}}});var ge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:R});const he=T({type:"code",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!1,render:(t,{children:e,attributes:n})=>u("pre",x(g({},n),{children:u("code",{children:e})})),toggle:{},events:{}});var me=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:he});const I=T({type:"heading",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!1,render:(t,{element:e,children:n,attributes:o})=>_.exports.createElement(`h${e.depth}`,o,n),toggle:{prefix:/^#{1,6}$/,estimatePrefixLength:6,toggle:(t,e,n)=>{n?c.setNodes(t,g({type:"heading"},n),{at:e}):(c.unsetNodes(t,"depth",{at:e}),c.setNodes(t,{type:"paragraph"},{at:e}))},onTrigger:t=>({depth:t.length})},events:{onStartDelete:(t,e)=>{const n=p.parent(t,e);return v(n,"heading")?(n.depth>1?I.toggle.toggle(t,i.parent(e),{depth:n.depth-1}):I.toggle.toggle(t,i.parent(e),!1),!0):!1},onStartEnter:(t,e)=>{const n=p.parent(t,e);return v(n,"heading")?(I.toggle.toggle(t,i.parent(e),!1),!0):!1},onTab:(t,e)=>{const n=p.parent(t,e);return v(n,"heading")?(n.depth<6&&I.toggle.toggle(t,i.parent(e),{depth:n.depth+1}),!0):!1}}});var _e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:I}),H=T({type:"image",isInline:!0,isVoid:!1,isLeaf:!1,render:(t,{element:e,attributes:n})=>u("img",g({alt:e.alt,src:e.url,title:e.title},n)),insert:(t,e,n)=>{c.insertNodes(t,[{text:" "},g({type:"image",children:[]},n),{text:" "}],{at:e})}}),be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:H});const C=T({type:"list",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!0,normalize:(t,e,n,o)=>{if(e.children.length===0){c.removeNodes(t,{at:n}),o();return}if(i.hasPrevious(n)){const r=p.get(t,i.previous(n));if(v(r,"list")&&r.ordered===e.ordered&&r.spread===e.spread&&r.start===void 0){c.mergeNodes(t,{at:n}),o();return}}},render(t,{element:e,attributes:n,children:o}){return e.ordered?u("ol",x(g({},n),{start:e.start,children:o})):u("ul",x(g({},n),{children:o}))},toggle:{prefix:/^-|\d+\.$/,toggle:(t,e,n)=>{if(!v(p.get(t,e),"paragraph"))throw new Error("can only call ListNode.toggle on a paragraph node.");if(n===!1){const o=i.parent(e),r=i.next(i.parent(o));c.splitNodes(t,{at:o}),c.moveNodes(t,{at:r.concat(0),to:r}),c.unwrapNodes(t,{at:r}),c.select(t,{path:r,offset:0})}else{const o=i.parent(e),r=p.get(t,o);if(v(r,"listItem")){if(i.hasPrevious(o)){const a=fe(t,o);c.moveNodes(t,{at:o,to:a}),c.wrapNodes(t,g({type:"list",children:[]},n),{at:a})}}else c.wrapNodes(t,{type:"listItem",checked:void 0,spread:n.spread,children:[]},{at:e}),c.wrapNodes(t,g({type:"list",children:[]},n),{at:e})}},onTrigger:t=>t==="-"?{ordered:!1,start:void 0,spread:void 0}:{ordered:!0,start:parseInt(t),spread:void 0}},events:{}});var ye=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:C});const we=T({type:"listItem",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!0,normalize:(t,e,n)=>{const o=e.children.length-1;if(e.children.length>1&&v(e.children[o],"paragraph")){const r=i.next(n);c.moveNodes(t,{at:n.concat(o),to:r}),c.wrapNodes(t,{type:"listItem",checked:e.checked,spread:e.spread,children:[]},{at:r})}},render(t,{element:e,attributes:n,children:o}){return u("li",x(g({},n),{children:o}))},toggle:{},events:{onStartDelete:(t,e)=>(C.toggle.toggle(t,i.parent(e),!1),!0),onStartEnter:(t,e)=>p.string(p.get(t,e))?!1:(C.toggle.toggle(t,i.parent(e),!1),!0),onTab:(t,e)=>{const n=p.parent(t,i.parent(i.parent(e)));if(v(n,"list")){const{spread:o,ordered:r}=n;return C.toggle.toggle(t,i.parent(e),{spread:o,ordered:r,start:void 0}),!0}else return console.warn(`bad structure, expect a list at ${e}-2`),!1}}});var xe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:we});const ke=T({type:"paragraph",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!1,toggle:{},events:{},render(t,{attributes:e,children:n}){return u("p",x(g({},e),{children:n}))}});var ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ke}),Ne=T({isLeaf:!0,render(t,{text:e,children:n,attributes:o}){let r=n;return e.delete&&(r=u("del",{children:r})),e.emphasis&&(r=u("em",{children:r})),e.strong&&(r=u("strong",{children:r})),e.inlineCode&&(r=u("code",{children:r})),u("span",x(g({},o),{children:r}))}}),Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ne});const Pe={"./blockquote/BlockquoteNode.tsx":ge,"./code/CodeNode.tsx":me,"./heading/HeadingNode.tsx":_e,"./image/ImageNode.tsx":be,"./list/ListItemNode.tsx":xe,"./list/ListNode.tsx":ye,"./paragraph/ParagraphNode.tsx":ve,"./text/TextNode.tsx":Te};function Ee(t){for(const[e,{default:n}]of Object.entries(Pe))typeof(n==null?void 0:n.register)=="function"&&(console.debug("auto detected",e),n.register(t))}const z=_.exports.forwardRef(({disabled:t=!1,initialMarkdown:e=""},n)=>{const o=_.exports.useMemo(()=>{const l=new de;return Ee(l),l},[]),r=_.exports.useMemo(()=>{const l=ee(te(ne()));return o.wrapEditor(l)},[]),a=_.exports.useMemo(()=>o.createDefaultEditableProps(r),[]),[h,P,s]=ue(r);return _.exports.useEffect(()=>{n&&(typeof n=="function"?n(h):n.current=h),h.markdown=e},[r]),u(re,{editor:r,onChange:s,value:P,children:u(se,g({className:"ti-community-editor"},a))})});z.displayName="TiEditor";z.propTypes={disabled:V.bool,initialMarkdown:V.string};z.defaultProps={disabled:!1,initialMarkdown:""};const Se=`## \u5F15\u7528 (blockquote)

\`\`\`markdown
> blockquote
> 
> yeah
\`\`\`

> blockquote
> 
> yeah

- \u6DFB\u52A0\u5F15\u7528
  - \u8F93\u5165 \`>\` \u5E76\u8F93\u5165\u7A7A\u683C
- \u5220\u9664\u5F15\u7528
  - \u5728\u5F15\u7528\u8D77\u59CB\u5904\u70B9\u51FB \`<Backspace>\`
`;var Me=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:Se});const Ie=`## \u6807\u9898

\`\`\`markdown
# h1
## h2
### h3
#### h4
##### h5
###### h6
\`\`\`

> # h1
> ## h2
> ### h3
> #### h4
> ##### h5
> ###### h6

- \u521B\u5EFA\u6807\u9898
  1. \u8F93\u5165 1-6 \u4E2A \`#\` \u5E76\u8F93\u5165\u7A7A\u683C
  2. \u5728\u6807\u9898\u4E2D\u95F4\u6216\u7ED3\u5C3E\u70B9\u51FB \`<Enter>\`
- \u8C03\u6574\u6807\u9898\u7EA7\u522B
  1. \u6309 \`<Tab>\` \u589E\u52A0\u6807\u9898\u7EA7\u522B
  2. \u5728\u6807\u9898\u8D77\u59CB\u5904\u70B9\u51FB \`<Backspace>\` \u4EE5\u964D\u7EA7
  3. \u5728\u6807\u9898\u8D77\u59CB\u5904\u70B9\u51FB \`<Enter>\` \u4EE5\u5C06\u6807\u9898\u8F6C\u6362\u6210\u6BB5\u843D
`;var Ce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:Ie});const ze=`## \u5217\u8868

\`\`\`markdown
- \u65E0\u5E8F\u5217\u8868
- ...
  - \u7F29\u8FDB\u5217\u8868

1. \u6709\u5E8F\u5217\u8868
\`\`\`

> - \u65E0\u5E8F\u5217\u8868
> - ...
>   - \u7F29\u8FDB\u5217\u8868
> 
> 1. \u6709\u5E8F\u5217\u8868 1
> 2. \u6709\u5E8F\u5217\u8868 2

\u4F7F\u7528\u4EE5\u4E0B\u65B9\u5F0F\u63A7\u5236 Markdown \u5217\u8868\uFF1A
- \u65B0\u5EFA\u5217\u8868\uFF1A
  1. \u8F93\u5165 \`-\` \u52A0\u7A7A\u683C\u63D2\u5165\u65E0\u5E8F\u5217\u8868
  2. \u8F93\u5165 \`number.\` \u52A0\u7A7A\u683C\u63D2\u5165\u6709\u5E8F\u5217\u8868
- \u5217\u8868\u7F29\u8FDB\uFF1A
  1. \u5728\u5217\u8868\u9879\u4E2D\u8F93\u5165 \`<Tab>\` \u751F\u6210\u4E0B\u7EA7\u5217\u8868 
  2. \u5728\u5217\u8868\u9879\u4E2D\u8F93\u5165 \`-\` \u6216 \`<number>\`\u3002
- \u53D6\u6D88\u5217\u8868
  1. \u5728\u7A7A\u5217\u8868\u9879\u4E2D\u76F4\u63A5\u8F93\u5165 \`<Enter>\`
`;var Le=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:ze});const Fe={"./slate-markdown/elements/blockquote/instructions.md":Me,"./slate-markdown/elements/heading/instructions.md":Ce,"./slate-markdown/elements/list/instructions.md":Le},Oe=Object.values(Fe).map(t=>t.plainText).join(`

`);function je(){const t=_.exports.useRef(null),[e,n]=_.exports.useState("");return _.exports.useEffect(()=>{const r=setInterval(()=>{var a,h;n((h=(a=t.current)==null?void 0:a.markdown)!=null?h:"")},1e3);return()=>clearInterval(r)},[]),q(oe,{children:["\u5DE6\u8FB9\u662F\u7F16\u8F91\u5668\uFF0C\u53F3\u8FB9\u662F\u7F16\u8F91\u5668\u5185\u5BB9\u5B9E\u9645\u7684 markdown",u("button",{onClick:()=>{var a;const r=t.current.editor;H.insert(r,(a=r.selection)!=null?a:[r.children.length-1],{url:"https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_92x30dp.png",alt:"",title:""})},children:"add img"}),q("div",{style:{display:"flex"},children:[u(z,{ref:t,initialMarkdown:Oe}),u("textarea",{onChange:r=>{n(r.currentTarget.value),t.current.markdown=r.currentTarget.value},value:e})]})]})}ae.render(u(ie.StrictMode,{children:u(je,{})}),document.getElementById("root"));
