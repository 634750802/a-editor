var ee=Object.defineProperty,te=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var j=(t,e,n)=>e in t?ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,b=(t,e)=>{for(var n in e||(e={}))re.call(e,n)&&j(t,n,e[n]);if($)for(var n of $(e))se.call(e,n)&&j(t,n,e[n]);return t},w=(t,e)=>te(t,ne(e));var P=(t,e,n)=>(j(t,typeof e!="symbol"?e+"":e,n),n);import{r as f,u as A,a as H,p as oe,b as ae,c as ie,d as le,E as S,j as u,R as C,T as p,e as F,f as K,g as U,h as G,i as J,F as ce,k as R,l as M,_ as D,N as g,P as c,m as ue,n as Q,o as pe,q as de,s as fe,w as ge,t as he,v as me,x as q,S as be,y as ye,z as W,A as _e,B as we,C as ve}from"./vendor.24eac52e.js";const xe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}};xe();class ke{constructor(e,n){P(this,"getMarkdownProcessor",A().use(H).use(oe).use(ae,{bullet:"-",listItemIndent:"one",fence:"`",rule:"-"}));P(this,"setMarkdownProcessor",A().use(H).use(ie).use(le));this.editor=e,this.setValue=n,this.getMarkdownProcessor.freeze(),this.setMarkdownProcessor.freeze()}get markdown(){return this.getMarkdownProcessor.stringify(this.getMarkdownProcessor.runSync({type:"root",children:this.editor.children}))}set markdown(e){this.setValue(this.setMarkdownProcessor.processSync(e).result),setTimeout(()=>{S.normalize(this.editor,{force:!0})},0)}}function Pe(t){const[e,n]=f.exports.useState([{type:"paragraph",children:[{text:""}]}]);return[f.exports.useMemo(()=>new ke(t,n),[t]),e,n]}function E(t){return w(b({},t),{register(e){e.define(t)}})}var T;(function(t){t.strong="strong",t.emphasis="emphasis",t.delete="delete",t.inlineCode="inlineCode"})(T||(T={}));const z=E({isLeaf:!0,render(t,{text:e,children:n,attributes:s}){let r=n;return e.delete&&(r=u("del",{children:r})),e.emphasis&&(r=u("em",{children:r})),e.strong&&(r=u("strong",{children:r})),e.inlineCode&&(r=u("code",{children:r})),u("span",w(b({},s),{children:r}))},toggleDecorator:(t,e,n)=>{V(t,e,n)?C.isCollapsed(e)?S.addMark(t,n,!1):p.setNodes(t,{[n]:!1},{match:F.isText,split:!0}):C.isCollapsed(e)?S.addMark(t,n,!0):p.setNodes(t,{[n]:!0},{match:F.isText,split:!0})},toolbarItems:[{key:T.strong,icon:K,tips:u("p",{children:"\u52A0\u7C97"})},{key:T.emphasis,icon:U},{key:T.inlineCode,icon:G},{key:T.delete,icon:J}].map(({key:t,icon:e,tips:n})=>({key:t,icon:u(ce,{icon:e}),isActive:(s,r)=>V(s,r,t),isDisabled:()=>!1,action:(s,r,a)=>{z.toggleDecorator(s,r,t)},tips:n}))});function V(t,e,n){if(!R.hasRange(t,e))return!1;const s=S.marks(t);return s?!!s[n]:!1}var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get TextNodeDecorator(){return T},isDecoratorActive:V,default:z});class Ne{constructor(){P(this,"blockConfigs",[]);P(this,"inlineConfigs",[]);P(this,"textConfig");P(this,"inlineSet",new Set);P(this,"voidSet",new Set);P(this,"customElementMap",new Map)}define(e){return e.isLeaf?this.textConfig=e:(e.isInline?(this.inlineSet.add(e.type),this.inlineConfigs.push(e)):this.blockConfigs.push(e),this.customElementMap.set(e.type,e),e.isVoid&&this.voidSet.add(e.type)),this}wrapEditor(e){const{isVoid:n,isInline:s,normalizeNode:r}=e;return e.updatePopper=()=>{},e.isVoid=a=>this.voidSet.has(a.type)||n(a),e.isInline=a=>this.inlineSet.has(a.type)||s(a),e.normalizeNode=a=>{let d=!0;S.withoutNormalizing(e,()=>{var i;const[y,o]=a;if(M.isElement(y)){const h=(i=this.customElementMap.get(y.type))==null?void 0:i.normalize;h&&h(e,y,o,()=>{d=!1})}}),d&&r(a)},e}createDefaultEditableProps(e){const n=o=>{var h;const{selection:i}=e;if(i&&C.isCollapsed(i)){const l=i.anchor,v=g.get(e,l.path),x=g.parent(e,l.path);if(F.isText(v)&&M.isElement(x)&&x.type==="paragraph"&&o.data===" "&&!c.hasPrevious(l.path)){const k=v.text.slice(0,l.offset);for(const{toggle:m}of this.blockConfigs)if(!(typeof m.estimatePrefixLength=="number"&&k.length>m.estimatePrefixLength)&&((h=m.prefix)==null?void 0:h.test(k))){const _=m.onTrigger(k);if(typeof _!="undefined"){p.delete(e,{at:{path:l.path,offset:0},distance:l.offset}),m.toggle(e,c.parent(l.path),_),o.preventDefault();return}}}}},s=o=>i=>{const{selection:h}=e;if(h&&C.isCollapsed(h)){const l=h.anchor;if(Se(e,l)){const v=c.parent(l.path),x=g.get(e,v);if(M.isElement(x)){const k=this.customElementMap.get(x.type);if(k){const m=o(k.events);if(m&&m(e,l.path)){i.preventDefault();return}}if(x.type==="paragraph"){const m=g.parent(e,v);if(!c.hasPrevious(v)&&M.isElement(m)){const _=this.customElementMap.get(m.type);if(_==null?void 0:_.wrappingParagraph){const I=o(_.events);if(I&&I(e,l.path)){i.preventDefault();return}}}}}}}},r=s(o=>o.onStartDelete),a=s(o=>o.onStartEnter),y=(o=>i=>{const{selection:h}=e;if(h&&C.isCollapsed(h)){const l=h.anchor,v=c.parent(l.path),x=g.parent(e,l.path);if(M.isElement(x)){const k=this.customElementMap.get(x.type);if(k){const m=o(k.events);if(m&&m(e,l.path)){i.preventDefault();return}}if(x.type==="paragraph"){const m=g.parent(e,v);if(M.isElement(m)){const _=this.customElementMap.get(m.type);if(_==null?void 0:_.wrappingParagraph){const I=o(_.events);if(I&&I(e,l.path)){i.preventDefault();return}}}}}}})(o=>o.onTab);return{renderElement:o=>{const i=this.customElementMap.get(o.element.type);return i?i.render(e,o):(console.warn(`${o.element.type} not impl`),f.exports.createElement("div",o.attributes,o.children))},renderLeaf:o=>this.textConfig?this.textConfig.render(e,o):f.exports.createElement("span",o.attributes,o.children),onDOMBeforeInput:o=>{X(e,()=>{switch(console.log(o.inputType),o.inputType){case"insertText":n(o);break;case"deleteContentBackward":r(o);break;case"insertParagraph":a(o);break;case"insertFromPaste":console.log(o);break}})},onKeyDown:o=>{X(e,()=>{if(D("tab",o)){y(o);return}if(D(["ctrl+enter"],o)){p.insertText(e,`
`);return}if(D("enter",o)&&e.selection){const i=g.parent(e,e.selection.anchor.path);if(S.isBlock(e,i)&&!/paragraph|heading/.test(i.type)){p.insertText(e,`
`),o.preventDefault();return}}if(e.selection){if(D("meta+b",o)){z.toggleDecorator(e,e.selection,T.strong),o.preventDefault();return}if(D("meta+i",o)){z.toggleDecorator(e,e.selection,T.emphasis),o.preventDefault();return}}})},onSelect:o=>{const i=window.getSelection();i&&(i.isCollapsed?e.hidePopper():(e.updatePopper(i.getRangeAt(0)),o.preventDefault(),o.stopPropagation()))},onBlur:o=>{e.hidePopper()}}}}function Se(t,e){return e.offset===0&&!c.hasPrevious(e.path)&&F.isText(g.get(t,e.path))}function X(t,e){let n=!0;S.withoutNormalizing(t,()=>{e(()=>{n=!1})}),n||S.normalize(t)}function N(t,e){return M.isElement(t)&&t.type===e}function Ee(t,e){const n=c.previous(e),s=g.get(t,n);return n.concat(s.children.length)}const Y=E({type:"blockquote",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!0,render:(t,{children:e,attributes:n})=>u("blockquote",w(b({},n),{children:e})),toggle:{prefix:/^>$/,toggle:(t,e,n)=>{n?p.wrapNodes(t,{type:"blockquote",children:[]},{at:e}):p.unwrapNodes(t,{at:c.parent(e)})},onTrigger(){return!0}},events:{onStartDelete:(t,e)=>{const n=g.parent(t,c.parent(e));return N(n,"blockquote")?(Y.toggle.toggle(t,c.parent(e),!1),!0):!1}}});var Me=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Y});const Ie=E({type:"code",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!1,render:(t,{children:e,attributes:n})=>u("pre",w(b({},n),{children:u("code",{children:e})})),toggle:{},events:{}});var Ce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ie});const L=E({type:"heading",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!1,render:(t,{element:e,children:n,attributes:s})=>f.exports.createElement(`h${e.depth}`,s,n),toggle:{prefix:/^#{1,6}$/,estimatePrefixLength:6,toggle:(t,e,n)=>{n?p.setNodes(t,b({type:"heading"},n),{at:e}):(p.unsetNodes(t,"depth",{at:e}),p.setNodes(t,{type:"paragraph"},{at:e}))},onTrigger:t=>({depth:t.length})},events:{onStartDelete:(t,e)=>{const n=g.parent(t,e);return N(n,"heading")?(n.depth>1?L.toggle.toggle(t,c.parent(e),{depth:n.depth-1}):L.toggle.toggle(t,c.parent(e),!1),!0):!1},onStartEnter:(t,e)=>{const n=g.parent(t,e);return N(n,"heading")?(L.toggle.toggle(t,c.parent(e),!1),!0):!1},onTab:(t,e)=>{const n=g.parent(t,e);return N(n,"heading")?(n.depth<6&&L.toggle.toggle(t,c.parent(e),{depth:n.depth+1}),!0):!1}}});var De=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:L}),Z=E({type:"image",isInline:!0,isVoid:!1,isLeaf:!1,render:(t,{element:e,attributes:n})=>u("img",b({alt:e.alt,src:e.url,title:e.title},n)),insert:(t,e,n)=>{p.insertNodes(t,[{text:" "},b({type:"image",children:[]},n),{text:" "}],{at:e})}}),ze=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Z});const B=E({type:"list",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!0,normalize:(t,e,n,s)=>{if(e.children.length===0){p.removeNodes(t,{at:n}),s();return}if(c.hasPrevious(n)){const r=g.get(t,c.previous(n));if(N(r,"list")&&r.ordered===e.ordered&&r.spread===e.spread&&r.start===void 0){p.mergeNodes(t,{at:n}),s();return}}},render(t,{element:e,attributes:n,children:s}){return e.ordered?u("ol",w(b({},n),{start:e.start,children:s})):u("ul",w(b({},n),{children:s}))},toggle:{prefix:/^-|\d+\.$/,toggle:(t,e,n)=>{if(!N(g.get(t,e),"paragraph"))throw new Error("can only call ListNode.toggle on a paragraph node.");if(n===!1){const s=c.parent(e),r=c.next(c.parent(s));p.splitNodes(t,{at:s}),p.moveNodes(t,{at:r.concat(0),to:r}),p.unwrapNodes(t,{at:r}),p.select(t,{path:r,offset:0})}else{const s=c.parent(e),r=g.get(t,s);if(N(r,"listItem")){if(c.hasPrevious(s)){const a=Ee(t,s);p.moveNodes(t,{at:s,to:a}),p.wrapNodes(t,b({type:"list",children:[]},n),{at:a})}}else p.wrapNodes(t,{type:"listItem",checked:void 0,spread:n.spread,children:[]},{at:e}),p.wrapNodes(t,b({type:"list",children:[]},n),{at:e})}},onTrigger:t=>t==="-"?{ordered:!1,start:void 0,spread:void 0}:{ordered:!0,start:parseInt(t),spread:void 0}},events:{}});var Le=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:B});const Fe=E({type:"listItem",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!0,normalize:(t,e,n)=>{const s=e.children.length-1;if(e.children.length>1&&N(e.children[s],"paragraph")){const r=c.next(n);p.moveNodes(t,{at:n.concat(s),to:r}),p.wrapNodes(t,{type:"listItem",checked:e.checked,spread:e.spread,children:[]},{at:r})}},render(t,{element:e,attributes:n,children:s}){return u("li",w(b({},n),{children:s}))},toggle:{},events:{onStartDelete:(t,e)=>(B.toggle.toggle(t,c.parent(e),!1),!0),onStartEnter:(t,e)=>g.string(g.get(t,e))?!1:(B.toggle.toggle(t,c.parent(e),!1),!0),onTab:(t,e)=>{const n=g.parent(t,c.parent(c.parent(e)));if(N(n,"list")){const{spread:s,ordered:r}=n;return B.toggle.toggle(t,c.parent(e),{spread:s,ordered:r,start:void 0}),!0}else return console.warn(`bad structure, expect a list at ${e}-2`),!1}}});var Be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Fe});const Oe=E({type:"paragraph",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!1,toggle:{},events:{},render(t,{attributes:e,children:n}){return u("p",w(b({},e),{children:n}))}});var je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Oe});const Re={"./blockquote/BlockquoteNode.tsx":Me,"./code/CodeNode.tsx":Ce,"./heading/HeadingNode.tsx":De,"./image/ImageNode.tsx":ze,"./list/ListItemNode.tsx":Be,"./list/ListNode.tsx":Le,"./paragraph/ParagraphNode.tsx":je,"./text/TextNode.tsx":Te};function qe(t){for(const[e,{default:n}]of Object.entries(Re))typeof(n==null?void 0:n.register)=="function"&&(console.debug("auto detected",e),n.register(t))}ue.add(K,U,J,G);function Ve(t,e){var r;if(!e)return[];const n=(r=R.toSlateRange(t,e,{exactMatch:!0}))!=null?r:t.selection;return z.toolbarItems.map(({key:a,isDisabled:d,isActive:y,action:o,icon:i,tips:h})=>({key:a,disabled:n?d(t,n):!1,active:n?y(t,n):!1,icon:i,action:n?l=>o(t,n,l):()=>{},tips:h}))}function $e({icon:t,active:e,action:n,tips:s}){const r=Q(),a=f.exports.useCallback(y=>{n&&(n(y),y.preventDefault(),y.stopPropagation(),R.focus(r))},[n]),d=u("span",{className:pe("toolbar-item",{active:e}),onMouseDown:a,children:t});return s?u(de,{content:s,children:d}):d}function Ae(){const[t,e]=f.exports.useState(0);return()=>{e(n=>n+1)}}function He(){const t=Q(),e=f.exports.useRef(null),n=f.exports.useRef(),[s,r]=f.exports.useState(!0),a=Ae();t.hidePopper=()=>r(!0);const d=f.exports.useMemo(()=>({getBoundingClientRect(){return n.current?n.current.getBoundingClientRect():{width:0,height:0}}}),[t,n]),{styles:y,attributes:o,update:i}=fe(d,e.current,{placement:"top",modifiers:[{name:"computeStyles",options:{adaptive:!1}},{name:"offset",options:{offset:[0,8]}}]}),h=Ve(t,n.current);return t.updatePopper=l=>{if(l){const v=!n.current;n.current=l,v&&setTimeout(()=>{t.updatePopper()},0)}h.length>0?(r(!1),i&&i()):r(!0),a()},u("div",w(b({className:"ti-hovering-toolbar",ref:e,style:w(b({},y.popper),{opacity:s?0:1,pointerEvents:s?"none":"initial"})},o.popper),{children:h.map(l=>u($e,{action:l.action,active:l.active,disabled:l.disabled,icon:l.icon},l.key))}))}const O=f.exports.forwardRef(({disabled:t=!1,initialMarkdown:e=""},n)=>{const s=f.exports.useMemo(()=>{const i=new Ne;return qe(i),i},[]),r=f.exports.useMemo(()=>{const i=ge(he(me()));return s.wrapEditor(i)},[]),a=f.exports.useMemo(()=>s.createDefaultEditableProps(r),[]),[d,y,o]=Pe(r);return f.exports.useEffect(()=>{n&&(typeof n=="function"?n(d):n.current=d),d.markdown=e},[r]),q(be,{editor:r,onChange:o,value:y,children:[u(He,{}),u(ye,b({className:"ti-community-editor"},a))]})});O.displayName="TiEditor";O.propTypes={disabled:W.bool,initialMarkdown:W.string};O.defaultProps={disabled:!1,initialMarkdown:""};const Ke=`## \u5F15\u7528 (blockquote)

\`\`\`markdown
> blockquote
> 
> yeah
\`\`\`

> blockquote
> 
> yeah

- \u6DFB\u52A0\u5F15\u7528
  - \u8F93\u5165 \`>\` \u5E76\u8F93\u5165\u7A7A\u683C
- \u5220\u9664\u5F15\u7528
  - \u5728\u5F15\u7528\u8D77\u59CB\u5904\u70B9\u51FB \`<Backspace>\`
`;var Ue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:Ke});const Ge=`## \u6807\u9898

\`\`\`markdown
# h1
## h2
### h3
#### h4
##### h5
###### h6
\`\`\`

> # h1
> ## h2
> ### h3
> #### h4
> ##### h5
> ###### h6

- \u521B\u5EFA\u6807\u9898
  1. \u8F93\u5165 1-6 \u4E2A \`#\` \u5E76\u8F93\u5165\u7A7A\u683C
  2. \u5728\u6807\u9898\u4E2D\u95F4\u6216\u7ED3\u5C3E\u70B9\u51FB \`<Enter>\`
- \u8C03\u6574\u6807\u9898\u7EA7\u522B
  1. \u6309 \`<Tab>\` \u589E\u52A0\u6807\u9898\u7EA7\u522B
  2. \u5728\u6807\u9898\u8D77\u59CB\u5904\u70B9\u51FB \`<Backspace>\` \u4EE5\u964D\u7EA7
  3. \u5728\u6807\u9898\u8D77\u59CB\u5904\u70B9\u51FB \`<Enter>\` \u4EE5\u5C06\u6807\u9898\u8F6C\u6362\u6210\u6BB5\u843D
`;var Je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:Ge});const Qe=`## \u5217\u8868

\`\`\`markdown
- \u65E0\u5E8F\u5217\u8868
- ...
  - \u7F29\u8FDB\u5217\u8868

1. \u6709\u5E8F\u5217\u8868
\`\`\`

> - \u65E0\u5E8F\u5217\u8868
> - ...
>   - \u7F29\u8FDB\u5217\u8868
> 
> 1. \u6709\u5E8F\u5217\u8868 1
> 2. \u6709\u5E8F\u5217\u8868 2

\u4F7F\u7528\u4EE5\u4E0B\u65B9\u5F0F\u63A7\u5236 Markdown \u5217\u8868\uFF1A
- \u65B0\u5EFA\u5217\u8868\uFF1A
  1. \u8F93\u5165 \`-\` \u52A0\u7A7A\u683C\u63D2\u5165\u65E0\u5E8F\u5217\u8868
  2. \u8F93\u5165 \`number.\` \u52A0\u7A7A\u683C\u63D2\u5165\u6709\u5E8F\u5217\u8868
- \u5217\u8868\u7F29\u8FDB\uFF1A
  1. \u5728\u5217\u8868\u9879\u4E2D\u8F93\u5165 \`<Tab>\` \u751F\u6210\u4E0B\u7EA7\u5217\u8868 
  2. \u5728\u5217\u8868\u9879\u4E2D\u8F93\u5165 \`-\` \u6216 \`<number>\`\u3002
- \u53D6\u6D88\u5217\u8868
  1. \u5728\u7A7A\u5217\u8868\u9879\u4E2D\u76F4\u63A5\u8F93\u5165 \`<Enter>\`
`;var We=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:Qe});const Xe={"./slate-markdown/elements/blockquote/instructions.md":Ue,"./slate-markdown/elements/heading/instructions.md":Je,"./slate-markdown/elements/list/instructions.md":We},Ye=Object.values(Xe).map(t=>t.plainText).join(`

`);function Ze(){const t=f.exports.useRef(null),[e,n]=f.exports.useState("");return f.exports.useEffect(()=>{const r=setInterval(()=>{var a,d;n((d=(a=t.current)==null?void 0:a.markdown)!=null?d:"")},1e3);return()=>clearInterval(r)},[]),q(_e,{children:["\u5DE6\u8FB9\u662F\u7F16\u8F91\u5668\uFF0C\u53F3\u8FB9\u662F\u7F16\u8F91\u5668\u5185\u5BB9\u5B9E\u9645\u7684 markdown",u("button",{onClick:()=>{var a;const r=t.current.editor;Z.insert(r,(a=r.selection)!=null?a:[r.children.length-1],{url:"https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_92x30dp.png",alt:"",title:""})},children:"add img"}),q("div",{style:{display:"flex"},children:[u(O,{ref:t,initialMarkdown:Ye}),u("textarea",{onChange:r=>{n(r.currentTarget.value),t.current.markdown=r.currentTarget.value},value:e})]})]})}we.render(u(ve.StrictMode,{children:u(Ze,{})}),document.getElementById("root"));
