var G=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var j=(t,e,n)=>e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,g=(t,e)=>{for(var n in e||(e={}))U.call(e,n)&&j(t,n,e[n]);if(V)for(var n of V(e))W.call(e,n)&&j(t,n,e[n]);return t},k=(t,e)=>J(t,Q(e));var v=(t,e,n)=>(j(t,typeof e!="symbol"?e+"":e,n),n);import{r as _,u as q,p as X,a as Y,b as Z,c as ee,d as te,E as w,j as u,R as I,T as c,e as C,f as S,_ as z,N as p,P as i,w as ne,g as re,h as se,S as ae,i as oe,k as $,l as R,F as ie,m as le,n as ce}from"./vendor.6282110e.js";const ue=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}};ue();class de{constructor(e,n){v(this,"getMarkdownProcessor",q().use(X).use(Y,{bullet:"-",listItemIndent:"one",fence:"`",rule:"-"}));v(this,"setMarkdownProcessor",q().use(Z).use(ee).use(te));this.editor=e,this.setValue=n,this.getMarkdownProcessor.freeze(),this.setMarkdownProcessor.freeze()}get markdown(){return this.getMarkdownProcessor.stringify(this.getMarkdownProcessor.runSync({type:"root",children:this.editor.children}))}set markdown(e){this.setValue(this.setMarkdownProcessor.processSync(e).result),setTimeout(()=>{w.normalize(this.editor,{force:!0})},0)}}function pe(t){const[e,n]=_.exports.useState([{type:"paragraph",children:[{text:""}]}]);return[_.exports.useMemo(()=>new de(t,n),[t]),e,n]}function P(t){return k(g({},t),{register(e){e.define(t)}})}var L;(function(t){t.strong="strong",t.emphasis="emphasis",t.delete="delete",t.inlineCode="inlineCode"})(L||(L={}));var B=P({isLeaf:!0,render(t,{text:e,children:n,attributes:a}){let r=n;return e.delete&&(r=u("del",{children:r})),e.emphasis&&(r=u("em",{children:r})),e.strong&&(r=u("strong",{children:r})),e.inlineCode&&(r=u("code",{children:r})),u("span",k(g({},a),{children:r}))},toggleDecorator(t,e){!t.selection||(fe(t,e)?I.isCollapsed(t.selection)?w.addMark(t,e,!1):c.setNodes(t,{[e]:!1},{match:C.isText,split:!0}):I.isCollapsed(t.selection)?w.addMark(t,e,!0):c.setNodes(t,{[e]:!0},{match:C.isText,split:!0}))}});function fe(t,e){const{selection:n}=t;if(!n)return!1;const[a]=w.nodes(t,{at:w.unhangRange(t,n),match:r=>!w.isEditor(r)&&C.isText(r)&&!!r[e]});return!!a}var ge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get TextNodeDecorator(){return L},default:B});class he{constructor(){v(this,"blockConfigs",[]);v(this,"inlineConfigs",[]);v(this,"textConfig");v(this,"inlineSet",new Set);v(this,"voidSet",new Set);v(this,"customElementMap",new Map)}define(e){return e.isLeaf?this.textConfig=e:(e.isInline?(this.inlineSet.add(e.type),this.inlineConfigs.push(e)):this.blockConfigs.push(e),this.customElementMap.set(e.type,e),e.isVoid&&this.voidSet.add(e.type)),this}wrapEditor(e){const{isVoid:n,isInline:a,normalizeNode:r}=e;return e.isVoid=o=>this.voidSet.has(o.type)||n(o),e.isInline=o=>this.inlineSet.has(o.type)||a(o),e.normalizeNode=o=>{let h=!0;w.withoutNormalizing(e,()=>{var l;const[E,s]=o;if(S.isElement(E)){const m=(l=this.customElementMap.get(E.type))==null?void 0:l.normalize;m&&m(e,E,s,()=>{h=!1})}}),h&&r(o)},e}createDefaultEditableProps(e){const n=s=>{var m;const{selection:l}=e;if(l&&I.isCollapsed(l)){const f=l.anchor,N=p.get(e,f.path),y=p.parent(e,f.path);if(C.isText(N)&&S.isElement(y)&&y.type==="paragraph"&&s.data===" "&&!i.hasPrevious(f.path)){const x=N.text.slice(0,f.offset);for(const{toggle:d}of this.blockConfigs)if(!(typeof d.estimatePrefixLength=="number"&&x.length>d.estimatePrefixLength)&&(console.log(d.prefix,"go",this.blockConfigs),(m=d.prefix)==null?void 0:m.test(x))){console.log(d.prefix,"go");const b=d.onTrigger(x);if(typeof b!="undefined"){c.delete(e,{at:{path:f.path,offset:0},distance:f.offset}),d.toggle(e,i.parent(f.path),b),s.preventDefault();return}}}}},a=s=>l=>{const{selection:m}=e;if(m&&I.isCollapsed(m)){const f=m.anchor;if(me(e,f)){const N=i.parent(f.path),y=p.get(e,N);if(S.isElement(y)){const x=this.customElementMap.get(y.type);if(x){const d=s(x.events);if(d&&d(e,f.path)){l.preventDefault();return}}if(y.type==="paragraph"){const d=p.parent(e,N);if(!i.hasPrevious(N)&&S.isElement(d)){const b=this.customElementMap.get(d.type);if(b==null?void 0:b.wrappingParagraph){const M=s(b.events);if(M&&M(e,f.path)){l.preventDefault();return}}}}}}}},r=a(s=>s.onStartDelete),o=a(s=>s.onStartEnter),E=(s=>l=>{const{selection:m}=e;if(m&&I.isCollapsed(m)){const f=m.anchor,N=i.parent(f.path),y=p.parent(e,f.path);if(S.isElement(y)){const x=this.customElementMap.get(y.type);if(x){const d=s(x.events);if(d&&d(e,f.path)){l.preventDefault();return}}if(y.type==="paragraph"){const d=p.parent(e,N);if(S.isElement(d)){const b=this.customElementMap.get(d.type);if(b==null?void 0:b.wrappingParagraph){const M=s(b.events);if(M&&M(e,f.path)){l.preventDefault();return}}}}}}})(s=>s.onTab);return{renderElement:s=>{const l=this.customElementMap.get(s.element.type);return l?l.render(e,s):(console.warn(`${s.element.type} not impl`),_.exports.createElement("div",s.attributes,s.children))},renderLeaf:s=>this.textConfig?this.textConfig.render(e,s):_.exports.createElement("span",s.attributes,s.children),onDOMBeforeInput:s=>{H(e,()=>{switch(console.log(s.inputType),s.inputType){case"insertText":n(s);break;case"deleteContentBackward":r(s);break;case"insertParagraph":o(s);break;case"insertFromPaste":console.log(s);break}})},onKeyDown:s=>{H(e,()=>{if(z("tab",s)){E(s);return}if(z(["ctrl+enter"],s)){c.insertText(e,`
`);return}if(z("enter",s)&&e.selection){const l=p.parent(e,e.selection.anchor.path);if(w.isBlock(e,l)&&!/paragraph|heading/.test(l.type)){c.insertText(e,`
`),s.preventDefault();return}}if(z("meta+b",s)){B.toggleDecorator(e,L.strong),s.preventDefault();return}if(z("meta+i",s)){B.toggleDecorator(e,L.emphasis),s.preventDefault();return}})}}}}function me(t,e){return e.offset===0&&!i.hasPrevious(e.path)&&C.isText(p.get(t,e.path))}function H(t,e){let n=!0;w.withoutNormalizing(t,()=>{e(()=>{n=!1})}),n||w.normalize(t)}function T(t,e){return S.isElement(t)&&t.type===e}function _e(t,e){const n=i.previous(e),a=p.get(t,n);return n.concat(a.children.length)}const A=P({type:"blockquote",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!0,render:(t,{children:e,attributes:n})=>u("blockquote",k(g({},n),{children:e})),toggle:{prefix:/^>$/,toggle:(t,e,n)=>{n?c.wrapNodes(t,{type:"blockquote",children:[]},{at:e}):c.unwrapNodes(t,{at:i.parent(e)})},onTrigger(){return!0}},events:{onStartDelete:(t,e)=>{const n=p.parent(t,i.parent(e));return T(n,"blockquote")?(A.toggle.toggle(t,i.parent(e),!1),!0):!1}}});var be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:A});const ye=P({type:"code",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!1,render:(t,{children:e,attributes:n})=>u("pre",k(g({},n),{children:u("code",{children:e})})),toggle:{},events:{}});var we=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ye});const D=P({type:"heading",isInline:!1,isLeaf:!1,isVoid:!1,wrappingParagraph:!1,render:(t,{element:e,children:n,attributes:a})=>_.exports.createElement(`h${e.depth}`,a,n),toggle:{prefix:/^#{1,6}$/,estimatePrefixLength:6,toggle:(t,e,n)=>{n?c.setNodes(t,g({type:"heading"},n),{at:e}):(c.unsetNodes(t,"depth",{at:e}),c.setNodes(t,{type:"paragraph"},{at:e}))},onTrigger:t=>({depth:t.length})},events:{onStartDelete:(t,e)=>{const n=p.parent(t,e);return T(n,"heading")?(n.depth>1?D.toggle.toggle(t,i.parent(e),{depth:n.depth-1}):D.toggle.toggle(t,i.parent(e),!1),!0):!1},onStartEnter:(t,e)=>{const n=p.parent(t,e);return T(n,"heading")?(D.toggle.toggle(t,i.parent(e),!1),!0):!1},onTab:(t,e)=>{const n=p.parent(t,e);return T(n,"heading")?(n.depth<6&&D.toggle.toggle(t,i.parent(e),{depth:n.depth+1}),!0):!1}}});var xe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:D}),K=P({type:"image",isInline:!0,isVoid:!1,isLeaf:!1,render:(t,{element:e,attributes:n})=>u("img",g({alt:e.alt,src:e.url,title:e.title},n)),insert:(t,e,n)=>{c.insertNodes(t,[{text:" "},g({type:"image",children:[]},n),{text:" "}],{at:e})}}),ke=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:K});const F=P({type:"list",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!0,normalize:(t,e,n,a)=>{if(e.children.length===0){c.removeNodes(t,{at:n}),a();return}if(i.hasPrevious(n)){const r=p.get(t,i.previous(n));if(T(r,"list")&&r.ordered===e.ordered&&r.spread===e.spread&&r.start===void 0){c.mergeNodes(t,{at:n}),a();return}}},render(t,{element:e,attributes:n,children:a}){return e.ordered?u("ol",k(g({},n),{start:e.start,children:a})):u("ul",k(g({},n),{children:a}))},toggle:{prefix:/^-|\d+\.$/,toggle:(t,e,n)=>{if(!T(p.get(t,e),"paragraph"))throw new Error("can only call ListNode.toggle on a paragraph node.");if(n===!1){const a=i.parent(e),r=i.next(i.parent(a));c.splitNodes(t,{at:a}),c.moveNodes(t,{at:r.concat(0),to:r}),c.unwrapNodes(t,{at:r}),c.select(t,{path:r,offset:0})}else{const a=i.parent(e),r=p.get(t,a);if(T(r,"listItem")){if(i.hasPrevious(a)){const o=_e(t,a);c.moveNodes(t,{at:a,to:o}),c.wrapNodes(t,g({type:"list",children:[]},n),{at:o})}}else c.wrapNodes(t,{type:"listItem",checked:void 0,spread:n.spread,children:[]},{at:e}),c.wrapNodes(t,g({type:"list",children:[]},n),{at:e})}},onTrigger:t=>t==="-"?{ordered:!1,start:void 0,spread:void 0}:{ordered:!0,start:parseInt(t),spread:void 0}},events:{}});var ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:F});const Te=P({type:"listItem",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!0,normalize:(t,e,n)=>{const a=e.children.length-1;if(e.children.length>1&&T(e.children[a],"paragraph")){const r=i.next(n);c.moveNodes(t,{at:n.concat(a),to:r}),c.wrapNodes(t,{type:"listItem",checked:e.checked,spread:e.spread,children:[]},{at:r})}},render(t,{element:e,attributes:n,children:a}){return u("li",k(g({},n),{children:a}))},toggle:{},events:{onStartDelete:(t,e)=>(F.toggle.toggle(t,i.parent(e),!1),!0),onStartEnter:(t,e)=>p.string(p.get(t,e))?!1:(F.toggle.toggle(t,i.parent(e),!1),!0),onTab:(t,e)=>{const n=p.parent(t,i.parent(i.parent(e)));if(T(n,"list")){const{spread:a,ordered:r}=n;return F.toggle.toggle(t,i.parent(e),{spread:a,ordered:r,start:void 0}),!0}else return console.warn(`bad structure, expect a list at ${e}-2`),!1}}});var Ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Te});const Pe=P({type:"paragraph",isLeaf:!1,isInline:!1,isVoid:!1,wrappingParagraph:!1,toggle:{},events:{},render(t,{attributes:e,children:n}){return u("p",k(g({},e),{children:n}))}});var Ee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Pe});const Se={"./blockquote/BlockquoteNode.tsx":be,"./code/CodeNode.tsx":we,"./heading/HeadingNode.tsx":xe,"./image/ImageNode.tsx":ke,"./list/ListItemNode.tsx":Ne,"./list/ListNode.tsx":ve,"./paragraph/ParagraphNode.tsx":Ee,"./text/TextNode.tsx":ge};function Me(t){for(const[e,{default:n}]of Object.entries(Se))typeof(n==null?void 0:n.register)=="function"&&(console.debug("auto detected",e),n.register(t))}const O=_.exports.forwardRef(({disabled:t=!1,initialMarkdown:e=""},n)=>{const a=_.exports.useMemo(()=>{const l=new he;return Me(l),l},[]),r=_.exports.useMemo(()=>{const l=ne(re(se()));return a.wrapEditor(l)},[]),o=_.exports.useMemo(()=>a.createDefaultEditableProps(r),[]),[h,E,s]=pe(r);return _.exports.useEffect(()=>{n&&(typeof n=="function"?n(h):n.current=h),h.markdown=e},[r]),u(ae,{editor:r,onChange:s,value:E,children:u(oe,g({className:"ti-community-editor"},o))})});O.displayName="TiEditor";O.propTypes={disabled:$.bool,initialMarkdown:$.string};O.defaultProps={disabled:!1,initialMarkdown:""};const Ie=`## \u5F15\u7528 (blockquote)

\`\`\`markdown
> blockquote
> 
> yeah
\`\`\`

> blockquote
> 
> yeah

- \u6DFB\u52A0\u5F15\u7528
  - \u8F93\u5165 \`>\` \u5E76\u8F93\u5165\u7A7A\u683C
- \u5220\u9664\u5F15\u7528
  - \u5728\u5F15\u7528\u8D77\u59CB\u5904\u70B9\u51FB \`<Backspace>\`
`;var Ce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:Ie});const ze=`## \u6807\u9898

\`\`\`markdown
# h1
## h2
### h3
#### h4
##### h5
###### h6
\`\`\`

> # h1
> ## h2
> ### h3
> #### h4
> ##### h5
> ###### h6

- \u521B\u5EFA\u6807\u9898
  1. \u8F93\u5165 1-6 \u4E2A \`#\` \u5E76\u8F93\u5165\u7A7A\u683C
  2. \u5728\u6807\u9898\u4E2D\u95F4\u6216\u7ED3\u5C3E\u70B9\u51FB \`<Enter>\`
- \u8C03\u6574\u6807\u9898\u7EA7\u522B
  1. \u6309 \`<Tab>\` \u589E\u52A0\u6807\u9898\u7EA7\u522B
  2. \u5728\u6807\u9898\u8D77\u59CB\u5904\u70B9\u51FB \`<Backspace>\` \u4EE5\u964D\u7EA7
  3. \u5728\u6807\u9898\u8D77\u59CB\u5904\u70B9\u51FB \`<Enter>\` \u4EE5\u5C06\u6807\u9898\u8F6C\u6362\u6210\u6BB5\u843D
`;var Le=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:ze});const De=`## \u5217\u8868

\`\`\`markdown
- \u65E0\u5E8F\u5217\u8868
- ...
  - \u7F29\u8FDB\u5217\u8868

1. \u6709\u5E8F\u5217\u8868
\`\`\`

> - \u65E0\u5E8F\u5217\u8868
> - ...
>   - \u7F29\u8FDB\u5217\u8868
> 
> 1. \u6709\u5E8F\u5217\u8868 1
> 2. \u6709\u5E8F\u5217\u8868 2

\u4F7F\u7528\u4EE5\u4E0B\u65B9\u5F0F\u63A7\u5236 Markdown \u5217\u8868\uFF1A
- \u65B0\u5EFA\u5217\u8868\uFF1A
  1. \u8F93\u5165 \`-\` \u52A0\u7A7A\u683C\u63D2\u5165\u65E0\u5E8F\u5217\u8868
  2. \u8F93\u5165 \`number.\` \u52A0\u7A7A\u683C\u63D2\u5165\u6709\u5E8F\u5217\u8868
- \u5217\u8868\u7F29\u8FDB\uFF1A
  1. \u5728\u5217\u8868\u9879\u4E2D\u8F93\u5165 \`<Tab>\` \u751F\u6210\u4E0B\u7EA7\u5217\u8868 
  2. \u5728\u5217\u8868\u9879\u4E2D\u8F93\u5165 \`-\` \u6216 \`<number>\`\u3002
- \u53D6\u6D88\u5217\u8868
  1. \u5728\u7A7A\u5217\u8868\u9879\u4E2D\u76F4\u63A5\u8F93\u5165 \`<Enter>\`
`;var Fe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",plainText:De});const Oe={"./slate-markdown/elements/blockquote/instructions.md":Ce,"./slate-markdown/elements/heading/instructions.md":Le,"./slate-markdown/elements/list/instructions.md":Fe},je=Object.values(Oe).map(t=>t.plainText).join(`

`);function Be(){const t=_.exports.useRef(null),[e,n]=_.exports.useState("");return _.exports.useEffect(()=>{const r=setInterval(()=>{var o,h;n((h=(o=t.current)==null?void 0:o.markdown)!=null?h:"")},1e3);return()=>clearInterval(r)},[]),R(ie,{children:["\u5DE6\u8FB9\u662F\u7F16\u8F91\u5668\uFF0C\u53F3\u8FB9\u662F\u7F16\u8F91\u5668\u5185\u5BB9\u5B9E\u9645\u7684 markdown",u("button",{onClick:()=>{var o;const r=t.current.editor;K.insert(r,(o=r.selection)!=null?o:[r.children.length-1],{url:"https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_92x30dp.png",alt:"",title:""})},children:"add img"}),R("div",{style:{display:"flex"},children:[u(O,{ref:t,initialMarkdown:je}),u("textarea",{onChange:r=>{n(r.currentTarget.value),t.current.markdown=r.currentTarget.value},value:e})]})]})}le.render(u(ce.StrictMode,{children:u(Be,{})}),document.getElementById("root"));
